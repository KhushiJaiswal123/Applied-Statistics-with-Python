<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Examples – Applied Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Applied Statistics</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./Syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Content.html"> 
<span class="menu-text">Content</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./Examples.html" aria-current="page"> 
<span class="menu-text">Examples</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Assignments.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Resources.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kostis-christodoulou/am01" target="_blank"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://mam2025.slack.com/" target="_blank"> <i class="bi bi-slack" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Overview</h2>
   
  <ul>
  <li><a href="#worked-examples" id="toc-worked-examples" class="nav-link active" data-scroll-target="#worked-examples">Worked Examples</a></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis"><strong>Exploratory Data Analysis</strong></a>
  <ul class="collapse">
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data">1. Import Data</a></li>
  <li><a href="#inspect-data" id="toc-inspect-data" class="nav-link" data-scroll-target="#inspect-data">2. Inspect Data</a></li>
  <li><a href="#clean-data" id="toc-clean-data" class="nav-link" data-scroll-target="#clean-data">3. Clean Data</a></li>
  <li><a href="#visualise-data" id="toc-visualise-data" class="nav-link" data-scroll-target="#visualise-data">4. Visualise Data</a></li>
  <li><a href="#manipulate-data" id="toc-manipulate-data" class="nav-link" data-scroll-target="#manipulate-data">5. Manipulate Data</a></li>
  <li><a href="#group-and-aggregate-data" id="toc-group-and-aggregate-data" class="nav-link" data-scroll-target="#group-and-aggregate-data">6. Group and Aggregate Data</a></li>
  </ul></li>
  <li><a href="#statistical-inference" id="toc-statistical-inference" class="nav-link" data-scroll-target="#statistical-inference"><strong>Statistical Inference</strong></a>
  <ul class="collapse">
  <li><a href="#intro" id="toc-intro" class="nav-link" data-scroll-target="#intro">Introduction to Statistical Inference</a></li>
  <li><a href="#probdist" id="toc-probdist" class="nav-link" data-scroll-target="#probdist">Probability Distributions</a></li>
  <li><a href="#Normal" id="toc-Normal" class="nav-link" data-scroll-target="#Normal">Normal (Gaussian) Distribution</a></li>
  <li><a href="#confidenceIntervals" id="toc-confidenceIntervals" class="nav-link" data-scroll-target="#confidenceIntervals">Confidence Intervals</a></li>
  <li><a href="#HypTesting" id="toc-HypTesting" class="nav-link" data-scroll-target="#HypTesting">Hypothesis Testing</a>
  <ul class="collapse">
  <li><a href="#interpreting-the-p-value" id="toc-interpreting-the-p-value" class="nav-link" data-scroll-target="#interpreting-the-p-value">Interpreting the p-value</a></li>
  <li><a href="#types-of-errors" id="toc-types-of-errors" class="nav-link" data-scroll-target="#types-of-errors">Types of Errors</a></li>
  <li><a href="#drawing-conclusions" id="toc-drawing-conclusions" class="nav-link" data-scroll-target="#drawing-conclusions">Drawing Conclusions</a></li>
  <li><a href="#tests-for-comparing-groups" id="toc-tests-for-comparing-groups" class="nav-link" data-scroll-target="#tests-for-comparing-groups">Tests for Comparing Groups</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#data-modelling" id="toc-data-modelling" class="nav-link" data-scroll-target="#data-modelling"><strong>Data Modelling</strong></a>
  <ul class="collapse">
  <li><a href="#DMintro" id="toc-DMintro" class="nav-link" data-scroll-target="#DMintro">Introduction</a></li>
  <li><a href="#classical-ml" id="toc-classical-ml" class="nav-link" data-scroll-target="#classical-ml">Classical Machine Learning</a></li>
  <li><a href="#modelling-process" id="toc-modelling-process" class="nav-link" data-scroll-target="#modelling-process">The Modelling Process</a></li>
  <li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation">Understanding Relationships: Correlation</a></li>
  <li><a href="#what-is-correlation" id="toc-what-is-correlation" class="nav-link" data-scroll-target="#what-is-correlation">What is Correlation?</a></li>
  <li><a href="#key-properties-of-correlation" id="toc-key-properties-of-correlation" class="nav-link" data-scroll-target="#key-properties-of-correlation">Key Properties of Correlation:</a></li>
  <li><a href="#interpreting-correlation-strength" id="toc-interpreting-correlation-strength" class="nav-link" data-scroll-target="#interpreting-correlation-strength">Interpreting Correlation Strength:</a></li>
  <li><a href="#visualizing-correlation" id="toc-visualizing-correlation" class="nav-link" data-scroll-target="#visualizing-correlation">Visualizing Correlation:</a></li>
  <li><a href="#regression-models" id="toc-regression-models" class="nav-link" data-scroll-target="#regression-models">Regression Models</a></li>
  <li><a href="#purposes-of-regression" id="toc-purposes-of-regression" class="nav-link" data-scroll-target="#purposes-of-regression">Purposes of Regression:</a></li>
  <li><a href="#terminology" id="toc-terminology" class="nav-link" data-scroll-target="#terminology">Terminology:</a></li>
  <li><a href="#linear-regression-equation" id="toc-linear-regression-equation" class="nav-link" data-scroll-target="#linear-regression-equation">Linear Regression Equation</a></li>
  <li><a href="#OLS" id="toc-OLS" class="nav-link" data-scroll-target="#OLS">Finding the Best Fit: Ordinary Least Squares</a></li>
  <li><a href="#r-squared" id="toc-r-squared" class="nav-link" data-scroll-target="#r-squared">Splitting Variability: Coefficient of Determination (<span class="math inline">\(R^2\)</span>)</a></li>
  <li><a href="#sampling-error" id="toc-sampling-error" class="nav-link" data-scroll-target="#sampling-error">Sampling Error in Regression and Significance of Estimates</a></li>
  <li><a href="#prediction-intervals" id="toc-prediction-intervals" class="nav-link" data-scroll-target="#prediction-intervals">Prediction Intervals</a></li>
  <li><a href="#collinearity" id="toc-collinearity" class="nav-link" data-scroll-target="#collinearity">Collinearity</a></li>
  <li><a href="#categorical-variables" id="toc-categorical-variables" class="nav-link" data-scroll-target="#categorical-variables">Categorical Variables</a></li>
  <li><a href="#regression-applications" id="toc-regression-applications" class="nav-link" data-scroll-target="#regression-applications">Examples of Regression Applications</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Examples</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="worked-examples" class="level1">
<h1>Worked Examples</h1>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Contents
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><a href="#basics">The Basics</a></li>
<li><a href="#EDA">Exploratory Data Analysis</a></li>
<li><a href="#Modelling">Data Modelling</a></li>
</ul>
</div>
</div>
</div>
<!--#################################################-->
<section id="basics" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="basics">The Basics</h3>
<!--#################################################-->
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Contents
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><a href="#varAndData">Variables and Data Types</a></li>
<li><a href="#basicOperations">Basic Operations</a></li>
<li><a href="#dataStructs">Data Structures</a></li>
<li><a href="#control%20flow">Control flow</a></li>
</ul>
</div>
</div>
</div>
<p>This section covers fundamental Python concepts that are essential for working with data and understanding the examples in the rest of this course. If you’re new to Python, spend some time here to get comfortable with the syntax and common operations.</p>
<!--#################################################-->
<section id="varAndData" class="level4">
<h4 class="anchored" data-anchor-id="varAndData">Variables and Data Types</h4>
<ul>
<li><strong>What are variables?</strong> (Containers for storing data)</li>
<li><strong>Common Data Types:</strong>
<ul>
<li><code>int</code> (Integers: <code>5</code>, <code>-10</code>)</li>
<li><code>float</code> (Floating-point numbers: <code>3.14</code>, <code>-0.5</code>)</li>
<li><code>str</code> (Strings: <code>'hello'</code>, <code>"Python Course"</code>)</li>
<li><code>bool</code> (Booleans: <code>True</code>, <code>False</code>)</li>
</ul></li>
<li><strong>How to assign variables:</strong> <code>my_number = 10</code>, <code>my_text = "Data"</code></li>
<li><strong>Checking data type:</strong> <code>type(my_number)</code></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>age <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>temperature <span class="op">=</span> <span class="fl">25.5</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>name <span class="op">=</span> <span class="st">"Alice"</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>is_student <span class="op">=</span> <span class="va">True</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Age: </span><span class="sc">{</span>age<span class="sc">}</span><span class="ss">, Type: </span><span class="sc">{</span><span class="bu">type</span>(age)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Temperature: </span><span class="sc">{</span>temperature<span class="sc">}</span><span class="ss">, Type: </span><span class="sc">{</span><span class="bu">type</span>(temperature)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Name: </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">, Type: </span><span class="sc">{</span><span class="bu">type</span>(name)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Is Student: </span><span class="sc">{</span>is_student<span class="sc">}</span><span class="ss">, Type: </span><span class="sc">{</span><span class="bu">type</span>(is_student)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="basicOperations" class="level4">
<h4 class="anchored" data-anchor-id="basicOperations">Basic Operations</h4>
<ul>
<li>Arithmetic Operators: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>**</code> (exponentiation), <code>%</code> (modulo)</li>
<li>Comparison Operators: <code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code></li>
<li>Logical Operators: and, or, not</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> <span class="dv">10</span> <span class="op">+</span> <span class="dv">5</span> <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Calculation: </span><span class="sc">{</span>result<span class="sc">}</span><span class="ss">"</span>) <span class="co"># Output: 20</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>is_greater <span class="op">=</span> (result <span class="op">&gt;</span> <span class="dv">15</span>) <span class="kw">and</span> (age <span class="op">&lt;</span> <span class="dv">40</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Is greater and age within range: </span><span class="sc">{</span>is_greater<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!--#################################################-->
<p>This section next section contains worked examples, most of them with fully annotated Python code that you can use as reference.</p>
</section>
</section>
<section id="EDA" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="EDA">Exploratory Data Analysis</h3>
<p>Before starting any analysis, we first need to import a dataset, understand its variables, visualize it, and manipulate it systematically using tools like <code>pandas</code>, <code>matplotlib</code>, and <code>seaborn.</code> This might seem like a tedious step, but it’s a critical foundation that must precede any form of statistical modelling.</p>
</section>
<section id="Modelling" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="Modelling">Data Modelling</h3>
<p>Data modelling allows us to move beyond describing individual variables — instead, we use models to learn from data. At the core of this is understanding the relationship:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># General form of a predictive model</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>outcome <span class="op">=</span> f(features) <span class="op">+</span> error</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We begin with Exploratory Data Analysis tailored for modelling, and then proceed with three key approaches:</p>
<ol type="1">
<li><p><strong>EDA for Modelling</strong> After importing and cleaning the data (using pandas), we start looking at summary statistics and plots that will be useful in framing our modelling approach</p></li>
<li><p><strong>Testing for Differences in Means</strong> across samples: How do we know whether there is a <strong>statistically significant difference</strong> between two groups A and B? E.g., between those who took a drug versus those than a placebo? Or whether there is a difference in the percentage of people who approve of Donald Trump is lower than those who disapprove of him?</p></li>
<li><p><strong>Fitting a Linear Regression Model</strong> To understand which features are associated with a numerical outcome <strong>Y</strong>, we use Linear Regression from <code>scikit-learn</code>. We try to explain the effect that specific explanatory variables, <strong>X</strong>, have on <strong>Y</strong></p></li>
<li><p><strong>Fitting a Binary Classification Model</strong> where the difference is that the outcome variable, <strong>Y</strong>, is binary (0/1). Again we want to use our model primarily for explanation, e.g., what is the effect of different explanatory variables <strong>X</strong>’s on e.g., the probability that someone with Covid-19 will die?</p></li>
</ol>
<!--#################################################-->
</section>
</section>
<section id="exploratory-data-analysis" class="level1">
<h1><strong>Exploratory Data Analysis</strong></h1>
<!--#################################################-->
<section id="import-data" class="level2">
<h2 class="anchored" data-anchor-id="import-data">1. Import Data</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Contents
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><a href="#overview">Overview</a>
<ul>
<li><a href="#importing">Importing CSV files: pandas.read_csv()</a></li>
<li><a href="#localImport">Importing CSV files saved locally</a></li>
</ul></li>
<li><a href="#speed">Need for speed: <code>dask</code> and <code>vaex</code></a></li>
<li><a href="#OtherFormats">Other data formats</a></li>
<li><a href="#rawData">Never work directly on the raw data</a></li>
<li><a href="#otherLinks">other Links</a></li>
</ul>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Learning Objectives</p>
<ol type="1">
<li><p>Load external data from a .csv file into a data frame.</p></li>
<li><p>Describe what a data frame is.</p></li>
<li><p>Use indexing to subset specific portions of data frames.</p></li>
<li><p>Describe what a factor is.</p></li>
<li><p>Reorder and rename factors.</p></li>
<li><p>Format dates.</p></li>
</ol>
</blockquote>
<section id="overview" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="overview">Overview</h3>
<p>When working with Python, data importation is generally achieved using libraries like <code>pandas</code>, which provides powerful tools for data manipulation, including importing data from various file formats.</p>
<!--#################################################-->
</section>
<section id="importing" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="importing">Importing CSV files: pandas.read_csv()</h3>
<p>CSV files can be imported using the <code>read_csv()</code> function from the <code>pandas</code> library. This function is fast and user-friendly, allowing you to read flat data without complex configurations.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing CSV file from a URL</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://data.giss.nasa.gov/gistemp/tabledata_v4/NH.Ts+dSST.csv"</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>weather <span class="op">=</span> pd.read_csv(url, skiprows<span class="op">=</span><span class="dv">1</span>, na_values<span class="op">=</span><span class="st">"***"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Options Used: * <code>skiprows=1</code>: This skips the first row, assuming the actual data starts from the second row. * <code>na_values= "***"</code> : This treats astriks’ as missing values, converting them to NaN.</p>
<p>To view the structure of the dataframe, you can use:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(weather.info())</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(weather.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!--#################################################-->
</section>
<section id="localImport" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="localImport">Importing CSV files saved locally</h3>
<p>To import a CSV file saved locally, simply provide the file path to the <code>read_csv()</code> function:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>weather_local <span class="op">=</span> pd.read_csv(<span class="st">"path/to/your/localfile.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!--#################################################-->
</section>
<section id="speed" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="speed">Need for speed: <code>dask</code> and <code>vaex</code></h3>
<p>For handling large datasets, libraries like dask and vaex can be used, which offer faster data processing capabilities compared to pandas.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> dask.dataframe <span class="im">as</span> dd</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>weather_large <span class="op">=</span> dd.read_csv(<span class="st">"path/to/largefile.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!--#################################################-->
</section>
<section id="OtherFormats" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="OtherFormats">Other data formats</h3>
<p>Python offers several libraries for reading and writing various data formats:</p>
<ul>
<li>Excel files: <code>pandas.read_excel()</code></li>
<li>JSON: <code>json</code> library</li>
<li>Web APIs: <code>requests</code> library</li>
<li>Databases: <code>sqlite3</code></li>
<li>Big Data: <code>pyspark</code></li>
</ul>
<!--#################################################-->
</section>
<section id="rawData" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="rawData">Never work directly on the raw data</h3>
<p>In 2012 Cecilia Giménez, an 83-year-old widow and amateur painter, attempted to restore a century-old fresco of Jesus crowned with thorns in her local church in Borja, Spain. The restoration didn’t go very well, but, surprisingly, the <a href="https://news.artnet.com/art-world/botched-restoration-of-jesus-fresco-miraculously-saves-spanish-town-197057">botched restoration of Jesus fresco miraculously saved the Spanish Town</a>.</p>
<p><img src="Images/raw_data_example.png" class="img-fluid"></p>
<p>As a most important rule, please do not work on the raw data; it’s unlikely you will have Cecilia Giménez’s good fortune to become (in)famous for your not-so-brilliant work.</p>
<p>Make sure you always work on a copy of your raw data. Use Python’s data manipulation libraries to clean and transform your data, and save the results to a new file, ensuring the original data remains intact.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>weather_cleaned <span class="op">=</span> weather.dropna()  <span class="co"># Example of cleaning data</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>weather_cleaned.to_csv(<span class="st">"cleaned_data.csv"</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!--#################################################-->
</section>
<section id="otherLinks" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="otherLinks">Other Links</h3>
<ul>
<li><a href="https://www.nytimes.com/2014/08/18/technology/for-big-data-scientists-hurdle-to-insights-is-janitor-work.html">For Big-Data Scientists, ‘Janitor Work’ Is Key Hurdle to Insights</a></li>
<li>Data Wrangling with <code>pandas</code>: <a href="https://pandas.pydata.org/docs/">Pandas Documentation</a></li>
<li>Big Data Processing with <code>dask</code> and <code>vaex</code>: <a href="https://dask.org/">Dask Documentation</a>, <a href="https://vaex.io/docs/">Vaex Documentation</a></li>
</ul>
<!--#################################################-->
</section>
</section>
<section id="inspect-data" class="level2">
<h2 class="anchored" data-anchor-id="inspect-data">2. Inspect Data</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Contents
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><a href="#overviewof2">Overview</a></li>
<li><a href="#viewing">Viewing Data</a></li>
<li><a href="#inspections">Detailed Inspection</a></li>
<li><a href="#questions">Key Questions</a></li>
</ul>
</div>
</div>
</div>
<!--#################################################-->
<section id="overviewof2" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="overviewof2">Overview</h3>
<p>Once you have loaded your dataset into Python, it’s essential to inspect and understand the data. Typically, you want to know:</p>
<ul>
<li>The dimensions of the dataset (number of rows and columns).</li>
<li>The types of variables (integer, string, boolean, etc.).</li>
<li>The number of missing values.</li>
<li>Summary statistics for numeric data.</li>
</ul>
<!--#################################################-->
</section>
<section id="viewing" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="viewing">Viewing Data</h3>
<p>In Python, you can use pandas to view and inspect your data. The pandas library provides several functions to achieve this.</p>
<p><code>pandas.DataFrame.info()</code> and <code>pandas.DataFrame.describe()</code></p>
<p>These functions help you understand the structure and summary statistics of your data.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>gapminder <span class="op">=</span> pd.read_csv(<span class="st">"path/to/gapminder.csv"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># View the structure of the dataframe</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(gapminder.info())</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(gapminder.describe())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Using <code>info()</code>: Provides the number of rows, columns, and data types of each column. Using <code>describe()</code> : Offers summary statistics for numeric columns, including count, mean, standard deviation, min, and max values.</p>
<!--#################################################-->
</section>
<section id="inspections" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="inspections">Detailed Inspection</h3>
<p>For a detailed inspection, you can use the pandas_profiling library, which provides an extensive report on your dataframe.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pandas_profiling <span class="im">import</span> ProfileReport</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a report</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>profile <span class="op">=</span> ProfileReport(gapminder)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>profile.to_file(<span class="st">"gapminder_report.html"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Example Analysis on London Bikes Data</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>bikes <span class="op">=</span> pd.read_csv(<span class="st">"path/to/londonBikes.csv"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use pandas_profiling for a detailed report</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>bikes_profile <span class="op">=</span> ProfileReport(bikes)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>bikes_profile.to_file(<span class="st">"london_bikes_report.html"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!--#################################################-->
</section>
<section id="questions" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="questions">Key Questions</h3>
<p>using the <strong>London Bikes Data</strong> from above</p>
<ol type="1">
<li>What kind of variable is <strong>date</strong>?
<ul>
<li>date is typically a string or datetime variable. You can convert it using <code>pd.to_datetime()</code>.</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>bikes[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(bikes[<span class="st">'date'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li>What kind of variable is <strong>season</strong>?
<ul>
<li>season is likely a categorical variable. You can convert it using <code>pd.Categorical()</code>.</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>bikes[<span class="st">'season'</span>] <span class="op">=</span> pd.Categorical(bikes[<span class="st">'season'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li>How often does it rain in London?
<ul>
<li>Count the occurrences in the rain column.</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>rain_count <span class="op">=</span> bikes[<span class="st">'rain'</span>].<span class="bu">sum</span>()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"It rains </span><span class="sc">{</span>rain_count<span class="sc">}</span><span class="ss"> times in the dataset."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li>What is the average annual temperature (in degrees C)?
<ul>
<li>Calculate the mean of the temperature columns.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>avg_temp <span class="op">=</span> bikes[[<span class="st">'max_temp'</span>, <span class="st">'min_temp'</span>, <span class="st">'avg_temp'</span>]].mean().mean()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The average annual temperature is </span><span class="sc">{</span>avg_temp<span class="sc">:.2f}</span><span class="ss"> degrees C."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li>What is the maximum rainfall?
<ul>
<li>Find the maximum value in the <code>rainfall_mm</code> column.</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>max_rainfall <span class="op">=</span> bikes[<span class="st">'rainfall_mm'</span>].<span class="bu">max</span>()</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The maximum rainfall recorded is </span><span class="sc">{</span>max_rainfall<span class="sc">}</span><span class="ss"> mm."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ol>
<!--#################################################-->
</section>
</section>
<section id="clean-data" class="level2">
<h2 class="anchored" data-anchor-id="clean-data">3. Clean Data</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Contents
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><a href="#overviewof3">Overview</a></li>
<li><a href="#cleaning">Cleaning Variable Names with pandas</a></li>
<li><a href="#codeQUality">Code Quality</a></li>
<li><a href="#otherLinks">Other Links</a></li>
</ul>
</div>
</div>
</div>
<!--#################################################-->
<section id="overviewof3" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="overviewof3">Overview</h3>
<p>When creating data files, it’s common to use variable names and formats that are human-readable but not ideal for computational processing. In Python, the <code>pandas</code> library can be used to clean and standardise variable names for easier manipulation.</p>
<!--#################################################-->
</section>
<section id="cleaning" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="cleaning">Cleaning Variable Names with pandas</h3>
<p>In <code>Python</code>, we can use pandas and custom code to read data and clean column names to make them more suitable for analysis.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Excel file</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>roster <span class="op">=</span> pd.read_excel(<span class="st">"path/to/dirty_data.xlsx"</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean column names using pandas string methods</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>roster.columns <span class="op">=</span> (</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    roster.columns</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">str</span>.strip()  <span class="co"># Remove leading and trailing spaces</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">str</span>.lower()  <span class="co"># Convert to lowercase</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">str</span>.replace(<span class="st">' '</span>, <span class="st">'_'</span>)  <span class="co"># Replace spaces with underscores</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">str</span>.replace(<span class="st">'%'</span>, <span class="st">'percent'</span>)  <span class="co"># Replace '%' with 'percent'</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">str</span>.replace(<span class="st">'[^a-zA-Z0-9_]'</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>)  <span class="co"># Remove special characters</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect cleaned dataframe</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(roster.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>The custom code directly modifies the column names using pandas string methods. It removes spaces, converts to lowercase, replaces spaces with underscores, and removes special characters using a regular expression.</li>
<li>Regular Expression: [^a-zA-Z0-9_] is used to remove any character that is not alphanumeric or an underscore.</li>
<li><code>pandas.read_excel()</code>: Used to read Excel files into a DataFrame.</li>
</ul>
<!--#################################################-->
</section>
<section id="codeQUality" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="codeQUality">Code Quality</h3>
<p>According to Phil Karlton, there are only two <a href="https://martinfowler.com/bliki/TwoHardThings.html">hard things in Computer Science: cache invalidation and naming things</a>. It’s crucial to write code that is not only functional but also maintainable and readable. Use meaningful names for variables and dataframes, and include comments to explain complex logic.</p>
<!--#################################################-->
</section>
<section id="otherLinks" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="otherLinks">Other Links</h3>
<ul>
<li><a href="https://www.nytimes.com/2014/08/18/technology/for-big-data-scientists-hurdle-to-insights-is-janitor-work.html">For Big-Data Scientists, ‘Janitor Work’ Is Key Hurdle to Insights</a></li>
</ul>
<!--#################################################-->
</section>
</section>
<section id="visualise-data" class="level2">
<h2 class="anchored" data-anchor-id="visualise-data">4. Visualise Data</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Contents
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><a href="#overviewof4">Overview</a></li>
<li><a href="#layers">Layers</a></li>
<li><a href="#faucetting">Faucetting</a></li>
<li><a href="#animated">Animated Graphs</a>
<ul>
<li><a href="#matplotLibrary">matplotlib</a></li>
</ul></li>
<li><a href="#whyPlot">Why you should always plot your data</a></li>
<li><a href="#furtherResources4">Further resources</a></li>
</ul>
</div>
</div>
</div>
<!--#################################################-->
<blockquote class="blockquote">
<p>Learning Objectives</p>
</blockquote>
<blockquote class="blockquote">
<ol type="1">
<li>Produce scatter plots, boxplots, and time series plots using matplotlib and seaborn.</li>
<li>Set universal plot settings.</li>
<li>Describe what faceting is and apply faceting using seaborn</li>
<li>Modify the aesthetics of an existing plot (including axis labels and colour).</li>
<li>Build complex and customised plots from data in a DataFrame.</li>
</ol>
</blockquote>
<!--#################################################-->
<section id="overviewof4" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="overviewof4">Overview</h3>
<blockquote class="blockquote">
<p>“Visualization is a powerful tool for understanding data. You can often discover patterns, spot anomalies, and develop an intuition for the data just by looking at it.”</p>
<p>— Wes McKinney, creator of pandas</p>
</blockquote>
<p>We will explore how to create insightful and aesthetically pleasing data visualisations using two powerful Python libraries: <code>matplotlib</code> and <code>seaborn</code>.<br>
We will work through examples of various plot types - scatter plots, boxplots, and histograms - and learn to customise them for clarity and impact.</p>
<p>It may seem verbose and unwieldy, but the idea of building a plot on a layer-by-layer basis is very powerful.</p>
<ul>
<li>You begin a plot by defining the dataset you will use.</li>
<li>Then, specify aesthetics, namely (x, y) coordinates, colour, size, etc.</li>
<li>Finally, choose the geometric shape to represent your data, and add more layers like legends, labels, facets, etc.</li>
</ul>
<p>For example, using the <a href="https://www.kaggle.com/datasets/albertovidalrod/gapminder-dataset?resource=download" target="_blank">Gapminder dataset</a> with data on life expectancy (life_exp), human development index (hdi_index), and GDP (gdp) for a number of countries, we can build a graph that shows the relationship between GDP and life expectancy.</p>
<p>As we said, first we define the dataset we are using</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="op">=</span> pd.read_csv(<span class="vs">r"filepath-to-your-dataset"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The next thing is to map aesthetics. In our case, we will map gdpPercap to the x-axis, and lifeExp to the y-axis.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic Plot Setup</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>gapminder, x<span class="op">=</span><span class="st">'gdp'</span>, y<span class="op">=</span><span class="st">'life_exp'</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Life Expectancy vs GDP'</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'GDP'</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Life Expectancy'</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="Images/BasicPlotSetup.png" class="img-fluid"></p>
<ul>
<li><code>plt.figure(figsize=(10, 6))</code>: Defines the size of the plot.</li>
<li><code>sns.scatterplot(...)</code>: Uses Seaborn to draw a scatter plot from the gapminder dataset.</li>
<li><code>plt.title(...)</code>, <code>plt.xlabel(...)</code>, <code>plt.ylabel(...)</code>: Add meaningful labels and a title to make the chart easy to understand.</li>
<li><code>plt.show()</code>: Renders the plot in your output window or notebook.</li>
</ul>
<p>What if we wanted to colour the points by the continent each country is in? For this we will need to use the “continent” column from our gapminder dataset. Seaborn makes this easy using the hue parameter.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Colored Scatter Plot by Continent</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))  <span class="co"># Set figure size</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>gapminder, x<span class="op">=</span><span class="st">'gdp'</span>, y<span class="op">=</span><span class="st">'life_exp'</span>, hue<span class="op">=</span><span class="st">'continent'</span>)  <span class="co"># Color points by continent</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Life Expectancy vs GDP by Continent'</span>)  <span class="co"># Updated title</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'GDP'</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Life Expectancy'</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Continent'</span>)  <span class="co"># Add a legend with a title</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="Images/ColouredScatterPlot.png" class="img-fluid"></p>
<ul>
<li><code>hue='continent'</code>: Tells Seaborn to color the points based on the continent each country belongs to.</li>
<li><code>plt.legend(...)</code>: Makes sure the legend is clear and labeled.</li>
</ul>
<p>What if instead of a scatter plot we wanted to create a line plot? For this we need to:</p>
<ul>
<li>change the <code>sns.scatterplot</code> to <code>sns.lineplot</code></li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Colored Line Plot by Continent</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))  <span class="co"># Set figure size</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>sns.lineplot(data<span class="op">=</span>gapminder, x<span class="op">=</span><span class="st">'gdp'</span>, y<span class="op">=</span><span class="st">'life_exp'</span>, hue<span class="op">=</span><span class="st">'continent'</span>)  <span class="co"># Color points by continent</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Life Expectancy vs GDP by Continent'</span>)  <span class="co"># Updated title</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'GDP'</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Life Expectancy'</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Continent'</span>)  <span class="co"># Add a legend with a title</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="Images/LineGraph.png" class="img-fluid"></p>
<p>However, this is not a particularly useful plot, so let us go back to our scatter plot.</p>
<p>What if we wanted to have the size of each point correspond to the HDI index of the country? For this we will :</p>
<ul>
<li>add the <code>size='hdi_index'</code> parameter in the <code>scatterplot()</code> function</li>
<li>add the <code>sizes=(20, 200)</code> parameter in the <code>scatterplot()</code> function to specify the range of sizes of scatter points we want to use.</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># going back to scatter plot but now the size of points coresspond to the population of the country</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic Plot Setup with size mapped to population</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>gapminder,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'gdp'</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'life_exp'</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">'hdi_index'</span>,                  <span class="co"># map size to population</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    sizes<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">200</span>),             <span class="co"># scale point size (min, max)</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Life Expectancy vs GDP (Point Size = hdi_index)'</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'GDP'</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Life Expectancy'</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'hdi_index'</span>, loc<span class="op">=</span><span class="st">'upper left'</span>, bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="Images/hdi_index.png" class="img-fluid"> But the points above are overlapping with each other. We can set the <code>alpha</code> variable between 0 and 1 to specify how transparent each point will be. This will let us see all the points better.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding Alpha</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>gapminder,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'gdp'</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'life_exp'</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">'hdi_index'</span>,                  <span class="co"># map size to population</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    sizes<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">200</span>),             <span class="co"># scale point size (min, max)</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.4</span>                    <span class="co"># make points a bit transparent</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Life Expectancy vs GDP (Point Size = hdi_index)'</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'GDP'</span>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Life Expectancy'</span>)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'hdi_index'</span>, loc<span class="op">=</span><span class="st">'upper left'</span>, bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="Images/Alpha.png" class="img-fluid"></p>
<p>Our graph is still not very clear after adding the <code>alpha</code> this is because all the points are bunched up in only a small section of the graph. We can <em>log</em> the x-axis to make the points more spread out across the GDP axis.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logging the axis</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>gapminder,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'gdp'</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'life_exp'</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">'hdi_index'</span>,                  <span class="co"># map size to population</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    sizes<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">200</span>),             <span class="co"># scale point size (min, max)</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.4</span>                    <span class="co"># make points a bit transparent</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Life Expectancy vs GDP (Point Size = hdi_index)'</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'GDP'</span>)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Life Expectancy'</span>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'hdi_index'</span>, loc<span class="op">=</span><span class="st">'upper left'</span>, bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>plt.xscale(<span class="st">'log'</span>)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="Images/AxisLogged.png" class="img-fluid"> We will now add the colour by continent parameter back.</p>
<p>For this notice that we are splitting the legends’ code into 2 separate sections.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding color by continent parameter back </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>scatter <span class="op">=</span> sns.scatterplot(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>gapminder,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'gdp'</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'life_exp'</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">'hdi_index'</span>,                  <span class="co"># map size to population</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    sizes<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">200</span>),             <span class="co"># scale point size (min, max)</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.4</span>,                       <span class="co"># make points a bit transparent</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    hue<span class="op">=</span><span class="st">'continent'</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Life Expectancy vs GDP (Point Size = hdi_index)'</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'GDP per capita (USD)'</span>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Life Expectancy (years)'</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate legends for hue and size</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'hdi_index'</span>, loc<span class="op">=</span><span class="st">'upper left'</span>, bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>sns.move_legend(scatter, title<span class="op">=</span><span class="st">'Continent'</span>, loc<span class="op">=</span><span class="st">'upper left'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">0.7</span>, <span class="fl">0.65</span>))</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>plt.tight_layout <span class="co"># making sure the legends are in the frame</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>plt.xscale(<span class="st">'log'</span>)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="Images/twoLegends.png" class="img-fluid"></p>
<!--#################################################-->
</section>
<section id="layers" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="layers">Layers</h3>
<p>Once you define your data and aesthetics (such as (x, y) coordinates, colour, size, etc.), you can add more layers to modify and enhance your plots.</p>
<ul>
<li><em>Geometric Object</em>s: These are the graphical objects to be drawn, such as histograms, boxplots, density plots, etc.</li>
<li><em>Statistics</em>: These can be applied to your data, like calculating density or fitting a regression line.</li>
<li><em>Position Adjustments</em>: These modify how elements are placed, such as jittering points or stacking bars.</li>
</ul>
<p>Example: Creating a Base plot - a histogram</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram with Position Adjustments</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>gapminder, x<span class="op">=</span><span class="st">'life_exp'</span>, hue<span class="op">=</span><span class="st">'continent'</span>, element<span class="op">=</span><span class="st">'step'</span>, fill<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Histogram of Life Expectancy by Continent'</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Life Expectancy'</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="Images/Histogram.png" class="img-fluid"></p>
<p>the “element” attribute can be one of “step”, “poly” or “bars” depending of what is needed. Try it out yourself.</p>
<p>We will now plot a density plot, a smoothed version of a histogram using geom_density; its default position is identity and both plots are equivalent.</p>
<ul>
<li>A histogram displays the frequency of data within bins, while a density plot represents the probability density function of the data, providing a smoothed continuous curve.</li>
<li>To convert a histogram to a density plot, you typically use <code>sns.kdeplot</code>, which computes and plots the kernel density estimate.</li>
</ul>
<p>In our code below, the <code>kdeplot</code> function is used to create a density plot, and the <code>common_norm=False</code> ensures that the densities for each continent are normalized separately, allowing for a fair comparison of the distribution shapes without being influenced by the differing sizes of the groups.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filled Density Plot</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>sns.kdeplot(data<span class="op">=</span>gapminder, x<span class="op">=</span><span class="st">'life_exp'</span>, hue<span class="op">=</span><span class="st">'continent'</span>, fill<span class="op">=</span><span class="va">True</span>, common_norm<span class="op">=</span><span class="va">False</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Density Plot of Life Expectancy by Continent'</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Life Expectancy'</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Density'</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="Images/densityPlot.png" class="img-fluid"></p>
<p>The “Multiple Parameter” The multiple Parameter can be set to any of these values:</p>
<ul>
<li><code>layer</code> - Overlays categories, allowing overlap.</li>
<li><code>stack</code> - Stacks categories cumulatively.</li>
<li><code>fill</code> - Stacks and scales categories to equal height.</li>
<li><code>dodge</code> - Positions categories side by side.</li>
</ul>
<p>e.g.&nbsp;using the dodge version:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>gapminder, x<span class="op">=</span><span class="st">'life_exp'</span>, hue<span class="op">=</span><span class="st">'continent'</span>, multiple<span class="op">=</span><span class="st">'dodge'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Life Expectancy Distribution by Continent'</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Life Expectancy'</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="Images/Dodged.png" class="img-fluid"> <!--#################################################--></p>
</section>
<section id="faucetting" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="faucetting">Faucetting</h3>
<p>Facetting is a powerful technique in data visualisation that allows you to split one plot into multiple plots based on a factor included in the dataset. Python’s <code>seaborn</code> library provides this functionality.</p>
<p>In the Gapminder scatterplot example, we can use faceting to produce one scatter plot for each continent separately, using <code>FacetGrid.</code></p>
<section id="define-the-core-scatter-plot" class="level4">
<h4 class="anchored" data-anchor-id="define-the-core-scatter-plot">Define the Core Scatter Plot</h4>
<p>First, let’s define the core scatter plot of life expectancy vs GDP and store it in an object for easy reuse:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base graph</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>gapminder, x<span class="op">=</span><span class="st">'gdp'</span>, y<span class="op">=</span><span class="st">'life_exp'</span>, hue<span class="op">=</span><span class="st">'continent'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>plt.xscale(<span class="st">'log'</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Life Expectancy vs GDP per capita, 1998-2002'</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'GDP per capita'</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Life Expectancy'</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="Images/baseGraph.png" class="img-fluid"></p>
<p>Now, let’s add a new layer to our base plot using FacetGrid to facet by continent:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure 'continent' is treated as a categorical variable</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>gapminder[<span class="st">'continent'</span>] <span class="op">=</span> gapminder[<span class="st">'continent'</span>].astype(<span class="st">'category'</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Facet the scatter plot by continent with hue</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.FacetGrid(gapminder, col<span class="op">=</span><span class="st">'continent'</span>, col_wrap<span class="op">=</span><span class="dv">3</span>, height<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>g.map_dataframe(sns.scatterplot, x<span class="op">=</span><span class="st">'gdp'</span>, y<span class="op">=</span><span class="st">'life_exp'</span>, hue<span class="op">=</span><span class="st">'continent'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>g.set_titles(<span class="st">"</span><span class="sc">{col_name}</span><span class="st">"</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>g.set_axis_labels(<span class="st">'GDP per capita'</span>, <span class="st">'Life Expectancy'</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>g.add_legend()</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><code>g.map_dataframe(...)</code>: Maps the sns.scatterplot function to each facet, passing the data explicitly and ensuring that</li>
<li><code>hue='continent'</code> colours the points appropriately in each facet.</li>
</ul>
<p><img src="Images/faucetGraph.png" class="img-fluid"></p>
<ul>
<li><code>FacetGrid</code>: This is used to create a grid of plots, allowing you to facet by a specified variable (continent in this case).</li>
<li><code>col_wrap</code>: This parameter controls the number of columns in the facet grid, making it adaptable to different screen sizes.</li>
<li><code>map</code>: This method maps a plotting function (sns.scatterplot) to each facet.</li>
</ul>
<p>Finally, if you want to create a boxplot of life expectancy by continent instead of a scatter plot, you can use similar aesthetics with Python libraries like matplotlib and seaborn. The key difference is the type of plot you choose to represent your data.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data<span class="op">=</span>gapminder, x<span class="op">=</span><span class="st">'continent'</span>, y<span class="op">=</span><span class="st">'life_exp'</span>, hue<span class="op">=</span><span class="st">'continent'</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels and title</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Life Expectancy among the continents, 1952-2007"</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">" "</span>)  <span class="co"># Empty, as the levels of the x-variable are the continents</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Life Expectancy"</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>plt.figtext(<span class="fl">0.9</span>, <span class="fl">0.01</span>, <span class="st">"Source: Gapminder"</span>, horizontalalignment<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply a minimal theme</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"whitegrid"</span>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="Images/boxAndWhiskers.png" class="img-fluid"></p>
<!--#################################################-->
</section>
</section>
<section id="animated" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="animated">Animated Graphs</h3>
<p>Animated graphs are a powerful way to visualize how data changes over time. In Python, one of the most commonly used tools for creating animations is Matplotlib’s <code>FuncAnimation</code> class. This function updates a plot frame-by-frame, allowing you to illustrate dynamic processes such as moving trends, changing patterns, or simulations. The final animation can be displayed directly in a notebook or exported as a GIF or video using writers like <code>pillow</code> or <code>ffmpeg.</code> Keep in mind that generating animations may take a few seconds, especially for longer sequences, as each frame is rendered individually.</p>
<!--#################################################-->
<section id="matplotLibrary" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="matplotLibrary">matplotlib.animation</h4>
<p>To implement animations, we will need to understand the concept of functions in Python. These are <em>reusable blocks of code that perform specific tasks and can be called with different inputs to produce different outputs</em>.</p>
<p>In the context of animations, a function—like <code>update()</code> in the code below - is used to define how each frame of the animation should be rendered based on changing input (e.g., the year). This function is then repeatedly called by FuncAnimation, allowing us to dynamically update the plot for each time step.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.animation <span class="im">as</span> animation</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the figure and axis</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get unique years sorted</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>years <span class="op">=</span> <span class="bu">sorted</span>(gapminder[<span class="st">'year'</span>].unique())</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> update(year_index):</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    ax.clear()  <span class="co"># Clear previous frame</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    year <span class="op">=</span> years[year_index]</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    yearly_data <span class="op">=</span> gapminder[gapminder[<span class="st">'year'</span>] <span class="op">==</span> year]</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create boxplot grouped by continent</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    yearly_data.boxplot(column<span class="op">=</span><span class="st">'life_exp'</span>, by<span class="op">=</span><span class="st">'continent'</span>, ax<span class="op">=</span>ax)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Customize plot appearance</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'Life Expectancy by Continent (</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">)'</span>)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">'Continent'</span>)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Life Expectancy'</span>)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    plt.suptitle(<span class="st">''</span>)  <span class="co"># Remove automatic title added by Pandas boxplot</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Create animation</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>ani <span class="op">=</span> animation.FuncAnimation(fig, update, frames<span class="op">=</span><span class="bu">len</span>(years), interval<span class="op">=</span><span class="dv">800</span>, repeat<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: Save as GIF (requires 'pillow')</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>ani.save(<span class="st">'life_expectancy_boxplot.gif'</span>, writer<span class="op">=</span><span class="st">'pillow'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="GIFs/life_expectancy_boxplot.gif" class="img-fluid"></p>
<p>Similarly, we can create an animated visualisation showing the relationship between GDP and life expectancy over time for different countries, segmented by continent.</p>
<ul>
<li><em>X-axis (GDP)</em>: Logarithmic scale representing each country’s GDP.</li>
<li><em>Y-axis (Life Expectancy)</em>: Life expectancy of each country’s population.</li>
<li><em>Data Points</em>
<ul>
<li>Each point represents a country for a specific year.</li>
<li>Colour-coded by continent:
<ul>
<li>Asia: Red</li>
<li>Europe: Blue</li>
<li>Africa: Green</li>
<li>Americas: Yellow</li>
<li>Oceania: Purple</li>
<li>Unknown: Grey</li>
</ul></li>
</ul></li>
<li><em>Animation</em>
<ul>
<li>Displays changes over time, with each frame representing a different year.</li>
<li>Title updates dynamically to reflect the current year.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill NaN values in the 'continent' column with a default value</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>gapminder[<span class="st">'continent'</span>] <span class="op">=</span> gapminder[<span class="st">'continent'</span>].fillna(<span class="st">'Unknown'</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the figure and axis</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get unique years sorted</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>years <span class="op">=</span> <span class="bu">sorted</span>(gapminder[<span class="st">'year'</span>].unique())</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> update(year_index):</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    ax.clear()  <span class="co"># Clear previous frame</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    year <span class="op">=</span> years[year_index]</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    yearly_data <span class="op">=</span> gapminder[gapminder[<span class="st">'year'</span>] <span class="op">==</span> year]</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure there are no NaN values in the data used for plotting</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    yearly_data <span class="op">=</span> yearly_data.dropna(subset<span class="op">=</span>[<span class="st">'gdp'</span>, <span class="st">'life_exp'</span>])</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Map continents to colours, handling 'Unknown' as grey</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>    continent_colors <span class="op">=</span> yearly_data[<span class="st">'continent'</span>].<span class="bu">map</span>({</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Asia'</span>: <span class="st">'red'</span>, <span class="st">'Europe'</span>: <span class="st">'blue'</span>, <span class="st">'Africa'</span>: <span class="st">'green'</span>, </span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Americas'</span>: <span class="st">'yellow'</span>, <span class="st">'Oceania'</span>: <span class="st">'purple'</span>, <span class="st">'Unknown'</span>: <span class="st">'grey'</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    }).fillna(<span class="st">'grey'</span>)  <span class="co"># Fill any remaining NaN values with 'grey'</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create scatter plot</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>    scatter <span class="op">=</span> ax.scatter(yearly_data[<span class="st">'gdp'</span>], yearly_data[<span class="st">'life_exp'</span>], </span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>                         c<span class="op">=</span>continent_colors, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Customize plot appearance</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'Year: </span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">'GDP'</span>)</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Life Expectancy'</span>)</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>    ax.set_xscale(<span class="st">'log'</span>)  <span class="co"># Use logarithmic scale for GDP</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(gapminder[<span class="st">'gdp'</span>].<span class="bu">min</span>(), gapminder[<span class="st">'gdp'</span>].<span class="bu">max</span>())</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(gapminder[<span class="st">'life_exp'</span>].<span class="bu">min</span>(), gapminder[<span class="st">'life_exp'</span>].<span class="bu">max</span>())</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Create animation</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>ani <span class="op">=</span> animation.FuncAnimation(fig, update, frames<span class="op">=</span><span class="bu">len</span>(years), interval<span class="op">=</span><span class="dv">800</span>, repeat<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: Save as GIF (requires 'pillow')</span></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>ani.save(<span class="st">'life_expectancy_vs_gdp.gif'</span>, writer<span class="op">=</span><span class="st">'pillow'</span>, dpi<span class="op">=</span><span class="dv">80</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="GIFs/life_expectancy_vs_gdp.gif" class="img-fluid"></p>
<!--#################################################-->
</section>
</section>
<section id="whyPlot" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="whyPlot">Why you should always plot your data</h3>
<p>We have touched on the basics of <strong>python</strong> visualisations, but in this section we wanted to discuss why one should <strong>always plot the data</strong> and not just rely on tables of summary statistics.</p>
<p>Let us consider thirteen datasets all of which have 142 observations of (x,y) values. The table below shows the average value of X and Y, the standard deviation of X and Y, as well as the correlation coefficient between X and Y.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">id</th>
<th style="text-align: left;">n</th>
<th style="text-align: left;">mean_x</th>
<th style="text-align: left;">mean_y</th>
<th style="text-align: left;">sd_x</th>
<th style="text-align: left;">sd_y</th>
<th style="text-align: left;">correlation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">142</td>
<td style="text-align: left;">54.3</td>
<td style="text-align: left;">47.8</td>
<td style="text-align: left;">6.82</td>
<td style="text-align: left;">6.9</td>
<td style="text-align: left;">-0.064</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">142</td>
<td style="text-align: left;">54.3</td>
<td style="text-align: left;">47.8</td>
<td style="text-align: left;">6.82</td>
<td style="text-align: left;">6.9</td>
<td style="text-align: left;">-0.069</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">142</td>
<td style="text-align: left;">54.3</td>
<td style="text-align: left;">47.8</td>
<td style="text-align: left;">6.82</td>
<td style="text-align: left;">6.9</td>
<td style="text-align: left;">-0.068</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">142</td>
<td style="text-align: left;">54.3</td>
<td style="text-align: left;">47.8</td>
<td style="text-align: left;">6.82</td>
<td style="text-align: left;">6.9</td>
<td style="text-align: left;">-0.064</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">142</td>
<td style="text-align: left;">54.3</td>
<td style="text-align: left;">47.8</td>
<td style="text-align: left;">6.82</td>
<td style="text-align: left;">6.9</td>
<td style="text-align: left;">-0.060</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: left;">142</td>
<td style="text-align: left;">54.3</td>
<td style="text-align: left;">47.8</td>
<td style="text-align: left;">6.82</td>
<td style="text-align: left;">6.9</td>
<td style="text-align: left;">-0.062</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: left;">142</td>
<td style="text-align: left;">54.3</td>
<td style="text-align: left;">47.8</td>
<td style="text-align: left;">6.82</td>
<td style="text-align: left;">6.9</td>
<td style="text-align: left;">-0.069</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: left;">142</td>
<td style="text-align: left;">54.3</td>
<td style="text-align: left;">47.8</td>
<td style="text-align: left;">6.82</td>
<td style="text-align: left;">6.9</td>
<td style="text-align: left;">-0.069</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: left;">142</td>
<td style="text-align: left;">54.3</td>
<td style="text-align: left;">47.8</td>
<td style="text-align: left;">6.82</td>
<td style="text-align: left;">6.9</td>
<td style="text-align: left;">-0.069</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: left;">142</td>
<td style="text-align: left;">54.3</td>
<td style="text-align: left;">47.8</td>
<td style="text-align: left;">6.82</td>
<td style="text-align: left;">6.9</td>
<td style="text-align: left;">-0.063</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: left;">142</td>
<td style="text-align: left;">54.3</td>
<td style="text-align: left;">47.8</td>
<td style="text-align: left;">6.82</td>
<td style="text-align: left;">6.9</td>
<td style="text-align: left;">-0.069</td>
</tr>
<tr class="even">
<td style="text-align: left;">12</td>
<td style="text-align: left;">142</td>
<td style="text-align: left;">54.3</td>
<td style="text-align: left;">47.8</td>
<td style="text-align: left;">6.82</td>
<td style="text-align: left;">6.9</td>
<td style="text-align: left;">-0.067</td>
</tr>
<tr class="odd">
<td style="text-align: left;">13</td>
<td style="text-align: left;">142</td>
<td style="text-align: left;">54.3</td>
<td style="text-align: left;">47.8</td>
<td style="text-align: left;">6.82</td>
<td style="text-align: left;">6.9</td>
<td style="text-align: left;">-0.066</td>
</tr>
</tbody>
</table>
<p>Since our datasets contain values for X and Y, we can estimate 13 regression models and plot the values for each of the 13 intercepts and slope for X.</p>
<p><img src="Images/LinearRegression_with95Confidence.png" class="img-fluid"></p>
<p>If we just looked at either the summary statistics table, or the plots of intercepts and slopes, we may be tempted to conclude that the 13 datasets are either identical or very much alike. However, this is far from the truth, as this is what the 13 individual datasets look like.</p>
<p><img src="Images/13_correlation_plots.png" class="img-fluid"></p>
<p>You can read more about why you <a href="https://www.research.autodesk.com/publications/same-stats-different-graphs/" target="_blank">should never trust summary statistics alone and should always visualize your data</a>.</p>
<!--#################################################-->
</section>
<section id="furtherResources4" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="furtherResources4">Further resources</h3>
<ul>
<li><a href="https://seaborn.pydata.org/tutorial.html" target="_blank">Official <code>seaborn</code> Tutorial</a></li>
<li><a href="https://matplotlib.org/stable/tutorials/introductory/pyplot.html" target="_blank"><code>matplotlib</code> Pyplot Tutorial</a></li>
<li><a href="https://www.datacamp.com/courses/introduction-to-data-visualization-with-seaborn?dc_referrer=https%3A%2F%2Fam01-sep24.netlify.app%2F" target="_blank">DataCamp - Data Visualization with Seaborn</a></li>
<li><a href="https://www.datacamp.com/courses/introduction-to-data-visualization-with-matplotlib" target="_blank">Datacamp - Introduction to Data Visualization with Matplotlib</a></li>
<li><a href="https://seaborn.pydata.org/examples/index.html" target="_blank"><code>seaborn</code> Gallery</a></li>
<li><a href="https://matplotlib.org/stable/gallery/index.html" target="_blank"><code>matplotlib</code> Examples</a></li>
</ul>
<!--#################################################-->
<!--#################################################-->
<!--#################################################-->
</section>
</section>
<section id="manipulate-data" class="level2">
<h2 class="anchored" data-anchor-id="manipulate-data">5. Manipulate Data</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Contents
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><a href="#select">Selecting and Filtering Data</a></li>
<li><a href="#filter">Handling Missing Values</a></li>
<li><a href="#FeatureEng">Creating New Variables (Feature Engineering Basics)</a></li>
<li><a href="#combiningDatasets">Combining Datasets</a></li>
<li><a href="#groupData">Reshaping Data (Pivoting and Melting)</a></li>
</ul>
</div>
</div>
</div>
<p>Once you’ve imported and inspected your data, the next crucial step in any data science workflow is data manipulation. This involves transforming raw data into a clean, structured, and analysis-ready format. Think of it as refining raw materials before building something incredible – whether it’s an insightful visualization or a powerful predictive model.</p>
<p>This section will introduce you to essential techniques using pandas, your go-to library for efficient data manipulation in Python. We’ll cover how to select and filter data, handle missing values, create new variables, and combine datasets.</p>
<!--#################################################-->
<section id="select" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="select">Selecting and Filtering Data</h3>
<p>Effectively extracting specific subsets of your data is fundamental. This allows you to focus on relevant information, analyze particular groups, or prepare data for specific operations.</p>
<p>You can select one or multiple columns from a pandas DataFrame using single or double square brackets.</p>
<ul>
<li>Selecting a single column</li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming 'gapminder' DataFrame is loaded from previous sections</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># (e.g., gapminder = pd.read_csv("filepath-to-your-dataset"))</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the 'life_exp' column</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>life_expectancy <span class="op">=</span> gapminder[<span class="st">'life_exp'</span>]</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(life_expectancy.head())</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(life_expectancy)) <span class="co"># Output will be &lt;class 'pandas.core.series.Series'&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Selecting multiple columns:</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select 'gdp' and 'life_exp' columns</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>gdp_life_exp <span class="op">=</span> gapminder[[<span class="st">'gdp'</span>, <span class="st">'life_exp'</span>]]</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(gdp_life_exp.head())</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(gdp_life_exp)) <span class="co"># Output will be &lt;class 'pandas.core.frame.DataFrame'&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Notice the difference in output type: a single column selection returns a Series, while multiple columns return a DataFrame.</p>
<!--#################################################-->
</section>
</section>
<section id="filter" class="level2 unnumbered unlisted">
<h2 class="unnumbered unlisted anchored" data-anchor-id="filter">Handling Missing Values</h2>
<p>Filtering rows, also known as subsetting, allows you to select data based on specific conditions. This is often done using boolean indexing.</p>
<ul>
<li>Filtering by a single condition: Let’s say we want to look at data only for the ‘Europe’ continent.</li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for data where continent is 'Europe'</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>europe_data <span class="op">=</span> gapminder[gapminder[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">'Europe'</span>]</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(europe_data.head())</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of rows for Europe: </span><span class="sc">{</span><span class="bu">len</span>(europe_data)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Filtering by multiple conditions: You can combine multiple conditions using logical operators (&amp; for AND, | for OR, ~ for NOT). Remember to wrap each condition in parentheses.</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for data where continent is 'Asia' AND life expectancy is greater than 70</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>asia_high_life_exp <span class="op">=</span> gapminder[(gapminder[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">'Asia'</span>) <span class="op">&amp;</span> (gapminder[<span class="st">'life_exp'</span>] <span class="op">&gt;</span> <span class="dv">70</span>)]</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(asia_high_life_exp.head())</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of rows for Asia with high life expectancy: </span><span class="sc">{</span><span class="bu">len</span>(asia_high_life_exp)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Real-world datasets are rarely perfect and often contain missing values (represented as NaN - Not a Number in pandas). Dealing with these is a critical step in data cleaning, as they can lead to errors or biased results in your analysis.</p>
<p>You’ve briefly touched on dropna() when saving a cleaned file, but here we’ll delve deeper into strategies.</p>
<ul>
<li>Identifying Missing Values: Use isnull() or isna() to get a boolean DataFrame indicating missing values, and sum() to count them per column.</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing values across the entire DataFrame</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(gapminder.isnull().<span class="bu">sum</span>())</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing values in a specific column, e.g., 'gdp'</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Missing values in 'gdp' column: </span><span class="sc">{</span>gapminder[<span class="st">'gdp'</span>]<span class="sc">.</span>isnull()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Dropping Missing Values: dropna() Removes rows or columns containing missing values.</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop rows with ANY missing values</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>df_cleaned_rows <span class="op">=</span> gapminder.dropna()</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Original rows: </span><span class="sc">{</span><span class="bu">len</span>(gapminder)<span class="sc">}</span><span class="ss">, Rows after dropping NaNs: </span><span class="sc">{</span><span class="bu">len</span>(df_cleaned_rows)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop columns with ANY missing values</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>df_cleaned_cols <span class="op">=</span> gapminder.dropna(axis<span class="op">=</span><span class="dv">1</span>) <span class="co"># axis=1 for columns</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Original columns: </span><span class="sc">{</span>gapminder<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">, Columns after dropping NaNs: </span><span class="sc">{</span>df_cleaned_cols<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop rows only if ALL values are missing</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>df_cleaned_all <span class="op">=</span> gapminder.dropna(how<span class="op">=</span><span class="st">'all'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Caution: Be careful when dropping data, especially rows. This can lead to significant data loss and might not always be the best approach, particularly with small datasets or if missingness carries important information.</p>
<ul>
<li>Imputing Missing Values (Filling): fillna() Replaces missing values with a specified value or method. This is generally preferred over dropping when you want to retain as much data as possible.</li>
</ul>
<div class="sourceCode" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill missing 'gdp' values with the mean of the 'gdp' column</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>mean_gdp <span class="op">=</span> gapminder[<span class="st">'gdp'</span>].mean()</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>gapminder_filled_mean <span class="op">=</span> gapminder[<span class="st">'gdp'</span>].fillna(mean_gdp)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"GDP after filling with mean:</span><span class="ch">\n</span><span class="sc">{</span>gapminder_filled_mean<span class="sc">.</span>head()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill missing values in 'continent' with 'Unknown' (as done in animation example)</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>gapminder[<span class="st">'continent'</span>] <span class="op">=</span> gapminder[<span class="st">'continent'</span>].fillna(<span class="st">'Unknown'</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Continent column after filling NaNs:</span><span class="ch">\n</span><span class="sc">{</span>gapminder[<span class="st">'continent'</span>]<span class="sc">.</span>value_counts()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Forward fill (propagates last valid observation forward to next valid)</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>gapminder_ffill <span class="op">=</span> gapminder[<span class="st">'life_exp'</span>].fillna(method<span class="op">=</span><span class="st">'ffill'</span>)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Backward fill (propagates next valid observation backward to next valid)</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>gapminder_bfill <span class="op">=</span> gapminder[<span class="st">'life_exp'</span>].fillna(method<span class="op">=</span><span class="st">'bfill'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Choosing an imputation strategy depends heavily on the nature of your data and the reason for the missingness. Common strategies include using the mean, median, mode, or more advanced techniques like interpolation.</p>
<!--#################################################-->
<section id="FeatureEng" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="FeatureEng">Creating New Variables (Feature Engineering Basics)</h3>
<p>Feature engineering is the process of creating new variables (features) from existing ones to improve the performance of predictive models or reveal new insights. This can be as simple as a mathematical transformation or as complex as extracting information from text. - Mathematical Operations: You can easily perform arithmetic operations on existing columns to create new ones.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new 'gdp_per_person' column</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>gapminder[<span class="st">'gdp_per_person'</span>] <span class="op">=</span> gapminder[<span class="st">'gdp'</span>] <span class="op">/</span> gapminder[<span class="st">'population'</span>]</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(gapminder[[<span class="st">'gdp'</span>, <span class="st">'population'</span>, <span class="st">'gdp_per_person'</span>]].head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Applying Functions: Use the .apply() method to apply a custom function to a Series or DataFrame.</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Categorize countries into 'High' or 'Low' life expectancy based on a threshold</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> categorize_life_exp(life_exp):</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'High'</span> <span class="cf">if</span> life_exp <span class="op">&gt;</span> <span class="dv">70</span> <span class="cf">else</span> <span class="st">'Low'</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>gapminder[<span class="st">'life_exp_category'</span>] <span class="op">=</span> gapminder[<span class="st">'life_exp'</span>].<span class="bu">apply</span>(categorize_life_exp)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(gapminder[[<span class="st">'life_exp'</span>, <span class="st">'life_exp_category'</span>]].head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Using numpy for Conditional Logic: For more complex conditional logic, numpy.where is very useful.</li>
</ul>
<div class="sourceCode" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a 'wealth_category' based on GDP</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>gapminder[<span class="st">'wealth_category'</span>] <span class="op">=</span> np.where(gapminder[<span class="st">'gdp'</span>] <span class="op">&gt;</span> <span class="dv">1000000000000</span>, <span class="st">'Very High'</span>,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>                                        np.where(gapminder[<span class="st">'gdp'</span>] <span class="op">&gt;</span> <span class="dv">100000000000</span>, <span class="st">'High'</span>, <span class="st">'Medium/Low'</span>))</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(gapminder[[<span class="st">'gdp'</span>, <span class="st">'wealth_category'</span>]].head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!--#################################################-->
</section>
<section id="combiningDatasets" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="combiningDatasets">Combining Datasets</h3>
<p>Often, the data you need for an analysis is spread across multiple files or DataFrames. pandas provides powerful functions to combine them. - Concatenating DataFrames (pd.concat()): Used to stack DataFrames vertically (rows) or horizontally (columns).</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create two small DataFrames for demonstration</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.DataFrame({<span class="st">'A'</span>: [<span class="st">'A0'</span>, <span class="st">'A1'</span>], <span class="st">'B'</span>: [<span class="st">'B0'</span>, <span class="st">'B1'</span>]}, index<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.DataFrame({<span class="st">'A'</span>: [<span class="st">'A2'</span>, <span class="st">'A3'</span>], <span class="st">'B'</span>: [<span class="st">'B2'</span>, <span class="st">'B3'</span>]}, index<span class="op">=</span>[<span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate vertically (default)</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>result_concat_rows <span class="op">=</span> pd.concat([df1, df2])</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Concatenated Rows:</span><span class="ch">\n</span><span class="st">"</span>, result_concat_rows)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate horizontally</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>df3 <span class="op">=</span> pd.DataFrame({<span class="st">'C'</span>: [<span class="st">'C0'</span>, <span class="st">'C1'</span>], <span class="st">'D'</span>: [<span class="st">'D0'</span>, <span class="st">'D1'</span>]}, index<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>result_concat_cols <span class="op">=</span> pd.concat([df1, df3], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Concatenated Columns:</span><span class="ch">\n</span><span class="st">"</span>, result_concat_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Merging DataFrames (pd.merge()): Similar to SQL joins, merge() combines DataFrames based on common columns (keys). This is crucial for combining related information from different sources.</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create two sample DataFrames: one with country info, one with additional stats</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>country_info <span class="op">=</span> pd.DataFrame({</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'country'</span>: [<span class="st">'Afghanistan'</span>, <span class="st">'Albania'</span>, <span class="st">'Algeria'</span>, <span class="st">'Angola'</span>],</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'capital'</span>: [<span class="st">'Kabul'</span>, <span class="st">'Tirana'</span>, <span class="st">'Algiers'</span>, <span class="st">'Luanda'</span>]</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>country_stats <span class="op">=</span> pd.DataFrame({</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'country'</span>: [<span class="st">'Afghanistan'</span>, <span class="st">'Albania'</span>, <span class="st">'Algeria'</span>, <span class="st">'Argentina'</span>],</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'population_2020'</span>: [<span class="dv">38928346</span>, <span class="dv">2877797</span>, <span class="dv">43851044</span>, <span class="dv">45195774</span>]</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Inner merge: only includes rows where the 'country' key exists in both DataFrames</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>merged_data_inner <span class="op">=</span> pd.merge(country_info, country_stats, on<span class="op">=</span><span class="st">'country'</span>, how<span class="op">=</span><span class="st">'inner'</span>)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Inner Merge:</span><span class="ch">\n</span><span class="st">"</span>, merged_data_inner)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Left merge: includes all rows from the left DataFrame and matching rows from the right</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>merged_data_left <span class="op">=</span> pd.merge(country_info, country_stats, on<span class="op">=</span><span class="st">'country'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Left Merge:</span><span class="ch">\n</span><span class="st">"</span>, merged_data_left)</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Right merge: includes all rows from the right DataFrame and matching rows from the left</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>merged_data_right <span class="op">=</span> pd.merge(country_info, country_stats, on<span class="op">=</span><span class="st">'country'</span>, how<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Right Merge:</span><span class="ch">\n</span><span class="st">"</span>, merged_data_right)</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Outer merge: includes all rows from both DataFrames, filling missing with NaN</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>merged_data_outer <span class="op">=</span> pd.merge(country_info, country_stats, on<span class="op">=</span><span class="st">'country'</span>, how<span class="op">=</span><span class="st">'outer'</span>)</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Outer Merge:</span><span class="ch">\n</span><span class="st">"</span>, merged_data_outer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Choosing the correct how argument (inner, left, right, outer) is essential depending on how you want to handle non-matching keys.</p>
<!--#################################################-->
</section>
<section id="groupData" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="groupData">Reshaping Data (Pivoting and Melting)</h3>
<p>Reshaping data involves changing the layout of your DataFrame. This is particularly useful when you need to transform data from a “long” format to a “wide” format, or vice-versa, for analysis or visualization.</p>
<p><strong>Pivoting (df.pivot_table() or df.pivot())</strong> Pivoting transforms unique values from one or more columns into new columns, typically aggregating data in the process. pivot_table is more flexible as it can handle duplicate entries in the index and allows for aggregation.</p>
<p>Imagine your gapminder data has multiple entries for a country across different years, and you want to see life expectancy for each continent as columns, with years as rows.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's create a simplified DataFrame for pivoting example</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>pivot_df <span class="op">=</span> gapminder[[<span class="st">'year'</span>, <span class="st">'continent'</span>, <span class="st">'life_exp'</span>]]</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean life expectancy per continent per year</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>avg_life_exp_pivot <span class="op">=</span> pivot_df.pivot_table(index<span class="op">=</span><span class="st">'year'</span>,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>                                          columns<span class="op">=</span><span class="st">'continent'</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>                                          values<span class="op">=</span><span class="st">'life_exp'</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>                                          aggfunc<span class="op">=</span><span class="st">'mean'</span>)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Pivoted Average Life Expectancy:</span><span class="ch">\n</span><span class="st">"</span>, avg_life_exp_pivot.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Melting (pd.melt())</strong></p>
<p>Melting is the opposite of pivoting; it transforms data from a “wide” format into a “long” format. This is useful for reshaping dataframes for certain types of analysis or plotting libraries (like Seaborn, which often prefers long-format data).</p>
<p>Consider our avg_life_exp_pivot from above. If we wanted to “unpivot” it back into a long format.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset index to make 'year' a regular column</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>avg_life_exp_pivot_reset <span class="op">=</span> avg_life_exp_pivot.reset_index()</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Melt the DataFrame</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>melted_life_exp <span class="op">=</span> pd.melt(avg_life_exp_pivot_reset,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>                         id_vars<span class="op">=</span>[<span class="st">'year'</span>], <span class="co"># Columns to keep as identifier variables</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>                         var_name<span class="op">=</span><span class="st">'continent'</span>, <span class="co"># Name for the new column storing melted column headers</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>                         value_name<span class="op">=</span><span class="st">'average_life_expectancy'</span>) <span class="co"># Name for the new column storing values</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Melted Average Life Expectancy:</span><span class="ch">\n</span><span class="st">"</span>, melted_life_exp.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!--#################################################-->
</section>
</section>
<section id="group-and-aggregate-data" class="level2">
<h2 class="anchored" data-anchor-id="group-and-aggregate-data">6. Group and Aggregate Data</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Contents
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><a href="#groupBy">The groupby() Method</a></li>
<li><a href="#agg">Common Aggregation Functions</a></li>
<li><a href="#multiColGroup">Grouping by Multiple Columns</a></li>
<li><a href="#multiArg">Applying Multiple Aggregations</a></li>
<li><a href="#Customfunctions">Using agg() with Custom Functions</a></li>
<li><a href="#pivotTables">Pivot Tables Revisited for Aggregation</a></li>
</ul>
</div>
</div>
</div>
<p>After you’ve cleaned and manipulated your data, you often need to summarize it to uncover patterns, trends, or characteristics within different categories. This is where grouping and aggregation become indispensable. These techniques allow you to perform calculations on subsets of your data, rather than on the entire dataset at once.</p>
<p>Think of it like getting summary reports for different departments in a company, rather than looking at every single transaction. You’re combining rows based on shared characteristics and then applying functions (like sum, average, count) to those groups.</p>
<p>This section will introduce you to groupby() and various aggregation functions in pandas, enabling you to derive meaningful insights from your prepared data</p>
<!--#################################################-->
<section id="groupBy" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="groupBy">The groupby() Method</h3>
<p>The core of grouping in pandas is the <code>groupby()</code> method. It allows you to split your DataFrame into groups based on one or more columns, apply a function to each group independently, and then combine the results into a single DataFrame. This process is often referred to as the “split-apply-combine” strategy.</p>
<p><strong>Basic Grouping</strong> Let’s use the gapminder dataset. A common task might be to find the average life expectancy for each continent.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming 'gapminder' DataFrame is loaded and 'continent' column is clean</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># (e.g., gapminder = pd.read_csv("filepath-to-your-dataset"))</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># If 'continent' has NaNs, ensure they are handled as per the previous chapter, e.g.,</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># gapminder['continent'] = gapminder['continent'].fillna('Unknown')</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'continent' and calculate the mean of 'life_exp'</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>avg_life_exp_by_continent <span class="op">=</span> gapminder.groupby(<span class="st">'continent'</span>)[<span class="st">'life_exp'</span>].mean()</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Average Life Expectancy by Continent:</span><span class="ch">\n</span><span class="st">"</span>, avg_life_exp_by_continent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In this example:</p>
<ol type="1">
<li>gapminder.groupby(‘continent’) splits the DataFrame into separate groups for each unique continent (e.g., ‘Asia’, ‘Europe’, ‘Africa’).</li>
<li>[‘life_exp’] selects the life_exp column from each of these groups.</li>
<li><code>.mean()</code> applies the mean function to the life_exp values within each continent group.</li>
<li>Pandas then combines these results into a new Series.</li>
</ol>
<!--#################################################-->
</section>
<section id="agg" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="agg">Common Aggregation Functions</h3>
<p>After grouping, you can apply various aggregation functions. Some of the most common include: - <code>.mean()</code>: Calculates the average. - <code>.sum()</code>: Calculates the total. - <code>.count()</code>: Counts non-null observations. - <code>.median()</code>: Calculates the median. - <code>.min()</code>: Finds the minimum value. - <code>.max()</code>: Finds the maximum value. - <code>.std()</code>: Calculates the standard deviation. - <code>.var()</code>: Calculates the variance. - <code>.size()</code>: Counts the total number of rows in each group (including NaNs).</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'continent' and find the sum of 'population'</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>total_pop_by_continent <span class="op">=</span> gapminder.groupby(<span class="st">'continent'</span>)[<span class="st">'population'</span>].<span class="bu">sum</span>()</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Total Population by Continent:</span><span class="ch">\n</span><span class="st">"</span>, total_pop_by_continent)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'year' and find the median 'gdp'</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>median_gdp_by_year <span class="op">=</span> gapminder.groupby(<span class="st">'year'</span>)[<span class="st">'gdp'</span>].median()</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Median GDP by Year:</span><span class="ch">\n</span><span class="st">"</span>, median_gdp_by_year.head())</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'continent' and find the number of unique countries</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>country_count_by_continent <span class="op">=</span> gapminder.groupby(<span class="st">'continent'</span>)[<span class="st">'country'</span>].nunique()</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Number of Unique Countries by Continent:</span><span class="ch">\n</span><span class="st">"</span>, country_count_by_continent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!--#################################################-->
</section>
<section id="multiColGroup" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="multiColGroup">Grouping by Multiple Columns</h3>
<p>You can group your data using more than one column. This creates hierarchical groups, allowing for more granular analysis.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'year' AND 'continent' to find average life expectancy</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>avg_life_exp_year_continent <span class="op">=</span> gapminder.groupby([<span class="st">'year'</span>, <span class="st">'continent'</span>])[<span class="st">'life_exp'</span>].mean()</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Average Life Expectancy by Year and Continent:</span><span class="ch">\n</span><span class="st">"</span>, avg_life_exp_year_continent.head(<span class="dv">10</span>))</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The result is a Series with a MultiIndex. You can access specific levels:</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Life expectancy for Europe in 1952:"</span>, avg_life_exp_year_continent.loc[(<span class="dv">1952</span>, <span class="st">'Europe'</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This multi-level index (MultiIndex) is very powerful for slicing and dicing your data further.</p>
<!--#################################################-->
</section>
<section id="multiArg" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="multiArg">Applying Multiple Aggregations</h3>
<p>Sometimes, you need to calculate several summary statistics for each group simultaneously. The <code>.agg()</code> method (or <code>.aggregate()</code>) is perfect for this.</p>
<p><strong>Aggregating a Single Column with Multiple Functions</strong></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'continent' and calculate mean, min, and max of 'life_exp'</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>multi_agg_life_exp <span class="op">=</span> gapminder.groupby(<span class="st">'continent'</span>)[<span class="st">'life_exp'</span>].agg([<span class="st">'mean'</span>, <span class="st">'min'</span>, <span class="st">'max'</span>, <span class="st">'std'</span>])</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Multiple Aggregations of Life Expectancy by Continent:</span><span class="ch">\n</span><span class="st">"</span>, multi_agg_life_exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Aggregating Multiple Columns with Multiple Functions</strong> You can specify different aggregation functions for different columns using a dictionary.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'continent' and aggregate 'life_exp' and 'gdp'</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>multi_col_agg <span class="op">=</span> gapminder.groupby(<span class="st">'continent'</span>).agg(</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    avg_life_exp<span class="op">=</span>(<span class="st">'life_exp'</span>, <span class="st">'mean'</span>), <span class="co"># Renames the output column to 'avg_life_exp'</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    total_gdp<span class="op">=</span>(<span class="st">'gdp'</span>, <span class="st">'sum'</span>),</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    min_pop<span class="op">=</span>(<span class="st">'population'</span>, <span class="st">'min'</span>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Multi-Column Aggregation by Continent:</span><span class="ch">\n</span><span class="st">"</span>, multi_col_agg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This gives you fine-grained control over your summary statistics, allowing you to name the resulting columns clearly.</p>
<!--#################################################-->
</section>
<section id="Customfunctions" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="Customfunctions">Using agg() with Custom Functions</h3>
<p>The <code>agg()</code> method is highly flexible and can even apply custom functions you define.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a custom function to calculate the range (max - min)</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> data_range(series):</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> series.<span class="bu">max</span>() <span class="op">-</span> series.<span class="bu">min</span>()</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'continent' and apply the custom 'data_range' function to 'life_exp'</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>custom_agg_life_exp <span class="op">=</span> gapminder.groupby(<span class="st">'continent'</span>)[<span class="st">'life_exp'</span>].agg(data_range)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Life Expectancy Range by Continent (Custom Function):</span><span class="ch">\n</span><span class="st">"</span>, custom_agg_life_exp)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co"># You can also pass a lambda function directly</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>lambda_agg_gdp <span class="op">=</span> gapminder.groupby(<span class="st">'continent'</span>)[<span class="st">'gdp'</span>].agg(<span class="kw">lambda</span> x: x.quantile(<span class="fl">0.75</span>) <span class="op">-</span> x.quantile(<span class="fl">0.25</span>))</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Interquartile Range of GDP by Continent (Lambda Function):</span><span class="ch">\n</span><span class="st">"</span>, lambda_agg_gdp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!--#################################################-->
</section>
<section id="pivotTables" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="pivotTables">Pivot Tables Revisited for Aggregation</h3>
<p>You’ve seen pivot_table used for reshaping. It’s also incredibly powerful for aggregation, often providing a more intuitive syntax than <code>groupby().agg()</code> for certain types of summaries.</p>
<p>Recall our example of average life expectancy by year and continent:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean life expectancy using pivot_table</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># index: the column(s) to become the new DataFrame index (rows)</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># columns: the column(s) whose unique values will become the new DataFrame columns</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># values: the column(s) to aggregate</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co"># aggfunc: the aggregation function (default is 'mean')</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>avg_life_exp_pivot_table <span class="op">=</span> pd.pivot_table(gapminder,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>                                          index<span class="op">=</span><span class="st">'year'</span>,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>                                          columns<span class="op">=</span><span class="st">'continent'</span>,</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>                                          values<span class="op">=</span><span class="st">'life_exp'</span>,</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>                                          aggfunc<span class="op">=</span><span class="st">'mean'</span>)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Average Life Expectancy by Year and Continent (using pivot_table):</span><span class="ch">\n</span><span class="st">"</span>, avg_life_exp_pivot_table.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The result is the same as the groupby([‘year’, ‘continent’])[‘life_exp’].mean() with an <code>unstack()</code> operation, but pivot_table often makes the intention clearer when you want a cross-tabulated summary.</p>
<p>You can also apply multiple aggregation functions in pivot_table:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot table with multiple aggregation functions for 'life_exp'</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>multi_agg_pivot_table <span class="op">=</span> pd.pivot_table(gapminder,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                                       index<span class="op">=</span><span class="st">'continent'</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>                                       values<span class="op">=</span><span class="st">'life_exp'</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>                                       aggfunc<span class="op">=</span>[<span class="st">'mean'</span>, <span class="st">'median'</span>, <span class="st">'std'</span>])</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Multiple Aggregations of Life Expectancy (using pivot_table):</span><span class="ch">\n</span><span class="st">"</span>, multi_agg_pivot_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Mastering grouping and aggregation allows you to transform large datasets into concise, insightful summaries that are essential for reporting, making decisions, and preparing data for more advanced analytical techniques.</p>
<!--#################################################-->
<!--#################################################-->
</section>
</section>
</section>
<section id="statistical-inference" class="level1">
<h1><strong>Statistical Inference</strong></h1>
<!--#################################################-->
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Contents
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><a href="#intro">Introduction to Statistical Inference</a></li>
<li><a href="#probdist">Probability Distributions</a></li>
<li><a href="#Normal">Normal (Gaussian) Distribution</a></li>
<li><a href="#Estimation">Estimation</a></li>
<li><a href="#confidenceIntervals">Confidence Intervals</a></li>
<li><a href="#HypTesting">Hypothesis Testing</a></li>
</ul>
</div>
</div>
</div>
<section id="intro" class="level2">
<h2 class="anchored" data-anchor-id="intro">Introduction to Statistical Inference</h2>
<p>This section will introduce the core ideas behind statistical inference, explaining how we move from simply describing data to making informed judgments about larger populations.</p>
<p><strong>What is Statistical Inference?</strong> - The goal is to predict and forecast values of population parameters, test hypotheses about them, and make decisions based on sample statistics derived from limited and incomplete sample information. - Population vs.&nbsp;Sample: Descriptive statistics describe the whole population (its properties are called parameters, e.g., μ, σ). Inferential statistics use a random sample to infer something about the population; properties calculated from samples are called sample statistics (estimators, e.g.&nbsp;<span class="math inline">\(\bar{x}\)</span>, s), which are used to estimate population parameters. Different samples will typically have different statistics.</p>
<!--#################################################-->
</section>
<section id="probdist" class="level2">
<h2 class="anchored" data-anchor-id="probdist">Probability Distributions</h2>
<p>Probability distributions are fundamental to statistical inference. They describe how data is spread and form the basis for many statistical tests.</p>
<p><strong>What are Probability Distributions?</strong> - A probability distribution is an expression that describes the relative frequency (height of the curve) for every possible outcome or a range of outcomes. - A probability model (e.g., the Normal distribution) attempts to capture the essential structure of the real world by asking what the world might look like if an infinite number of observations were obtained. - The main purpose of a distribution is to indicate error, not accuracy; no single observation is a perfect example of generality.</p>
<!--#################################################-->
</section>
<section id="Normal" class="level2">
<h2 class="anchored" data-anchor-id="Normal">Normal (Gaussian) Distribution</h2>
<ul>
<li>Properties: Bell-shaped curve.</li>
<li>Standard Normal Distribution (Z-distribution): A special case where the mean (μ) is 0 and the standard deviation (σ) is 1, as shown below.</li>
</ul>
<p><img src="Images/normal_or_z_dist.png" class="img-fluid"></p>
<ul>
<li>Z-score: Represents the number of standard deviations an observation falls above or below the mean, hense Z = (observation−mean)/SD</li>
</ul>
<p><img src="Images/zScoreFormula.png" class="img-fluid"></p>
<ul>
<li>Approximately 95% of observations fall within ±1.96 standard deviations of the mean in a Normal distribution. Observations with a Z-score &gt; 2 or &lt; -2 are usually considered unusual.</li>
</ul>
<p><img src="Images/normalDist_with_CI.jpg" class="img-fluid"></p>
<ul>
<li>Caution: Not all continuous variables are normally distributed; some are skewed, and the Normal distribution allows for negative values, which may not be appropriate for all real-world data.</li>
</ul>
<p>The Normal is just 1 distributions, there are many such distributions including Uniform, Binomial, Exponential, and Log-Normal distributions (But we will not be looking at any of these other distributions)</p>
<!--#################################################-->
</section>
<section id="confidenceIntervals" class="level2">
<h2 class="anchored" data-anchor-id="confidenceIntervals">Confidence Intervals</h2>
<p>This section focuses on interval estimation, providing a range within which the true population parameter is likely to fall, along with a specified level of confidence.</p>
<p><strong>What is a Confidence Interval?</strong> - Confidence Intervals: Provide a range within which the true population parameter is likely to fall. - Confidence Level: Typically 90%, 95%, or 99% (e.g., “We are 95% confident that the true population mean lies within this interval”). - Confidence level + signficiance level = 100% - So if we have a 95% confidence level, we can say we have a significance level a 5% OR a significance level of 2.5% in each tail.</p>
<p><img src="Images/sigLevels.png" class="img-fluid"></p>
<p><strong>Constructing Confidence Intervals for Means:</strong></p>
<ul>
<li><strong>Distribution:</strong> It uses the <strong>t-distribution</strong> with degrees of freedom (df) equal to <span class="math inline">\(n-1\)</span>.</li>
<li><strong>Conditions:</strong> The conditions for using this method are:
<ul>
<li>The sample size (<span class="math inline">\(n\)</span>) is greater than or equal to 30 (<span class="math inline">\(n \ge 30\)</span>).</li>
<li><strong>OR</strong> the data is approximately normally distributed.</li>
</ul></li>
<li><strong>Standard Error (SE):</strong> The standard error for the mean is calculated as:</li>
</ul>
<p><span class="math display">\[ \text{SE} = \sqrt{\frac{s^2}{n}} = \frac{s}{\sqrt{n}} \]</span></p>
<p>where <span class="math inline">\(s\)</span> is the sample standard deviation and <span class="math inline">\(n\)</span> is the sample size.</p>
<p><strong>Constructing Confidence Intervals for Proportions:</strong></p>
<ul>
<li><strong>Distribution:</strong> It typically uses the <strong>Normal distribution</strong>.</li>
<li><strong>Conditions:</strong> The conditions for using this method (often called the “success-failure condition”) are met when:
<ul>
<li>The number of expected “successes” (<span class="math inline">\(np\)</span>) is at least 10 (<span class="math inline">\(np \ge 10\)</span>).</li>
<li><strong>AND</strong> the number of expected “failures” (<span class="math inline">\(n(1-p)\)</span>) is also at least 10 (<span class="math inline">\(n(1-p) \ge 10\)</span>).</li>
<li><em>Note: In practice, we often use the sample proportion <span class="math inline">\(\hat{p}\)</span> instead of the true proportion <span class="math inline">\(p\)</span> to check these conditions, i.e., <span class="math inline">\(n\hat{p} \ge 10\)</span> and <span class="math inline">\(n(1-\hat{p}) \ge 10\)</span>.</em></li>
</ul></li>
<li><strong>Standard Error (SE):</strong> The standard error for the proportion is calculated using the sample proportion (<span class="math inline">\(\hat{p}\)</span>):</li>
</ul>
<p><span class="math display">\[ \text{SE} = \sqrt{\frac{\hat{p}(1-\hat{p})}{n}} \]</span></p>
<p>where <span class="math inline">\(\hat{p}\)</span> is the sample proportion and <span class="math inline">\(n\)</span> is the sample size.</p>
<p><strong>Bootstrapping</strong> Bootstrap Estimation: Can be used for confidence intervals. The process involves specifying variables, generating data (via bootstrapping), calculating a statistic, and visualizing. In Python, this is achieved using NumPy for data manipulation and random sampling, SciPy’s bootstrap function for efficient resampling and confidence interval calculation, and Matplotlib or Seaborn for visualizing the bootstrap distribution.</p>
<!--#################################################-->
</section>
<section id="HypTesting" class="level2">
<h2 class="anchored" data-anchor-id="HypTesting">Hypothesis Testing</h2>
<p>This is the core of statistical inference, where we formally test claims or assumptions about a population using evidence from our sample.</p>
<ul>
<li><p><strong>Null Hypothesis (<span class="math inline">\(H_0\)</span>):</strong> This is a statement of no effect or no difference. It represents a model of the world under the assumption that the effect we are investigating is not real (e.g., there is no difference between two groups, or a new drug has no effect). We assume the null hypothesis is true until we find sufficient evidence to the contrary.</p></li>
<li><p><strong>Alternative Hypothesis (<span class="math inline">\(H_A\)</span> or <span class="math inline">\(H_1\)</span>):</strong> This is the claim we are trying to find evidence for. It proposes that there <em>is</em> an effect or a difference (e.g., there <em>is</em> a difference between groups, or the new drug <em>does</em> have an effect).</p></li>
<li><p><strong>Significance Level (<span class="math inline">\(\alpha\)</span>):</strong> This is the predetermined threshold for how improbable the observed data must be, assuming the null hypothesis is true, for us to reject the null hypothesis. It represents the maximum probability of making a Type I error that we are willing to accept.</p>
<ul>
<li>Commonly set at 5% (0.05).</li>
<li>Can be set lower, such as 1% (0.01) or less, particularly in fields where false positives are costly (e.g., medicine, particle physics).</li>
<li>This concept is analogous to the legal principle of “beyond reasonable doubt” in a court of law.</li>
</ul></li>
<li><p><strong>p-value:</strong> The p-value is the probability of observing data as extreme as, or more extreme than, what was actually observed, <em>assuming that the null hypothesis (<span class="math inline">\(H_0\)</span>) is true</em>. It quantifies the strength of evidence against the null hypothesis.</p></li>
</ul>
<section id="interpreting-the-p-value" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-the-p-value">Interpreting the p-value</h3>
<ul>
<li><p><strong>If the p-value &lt; <span class="math inline">\(\alpha\)</span>:</strong> This means the observed data is highly improbable if the null hypothesis were true. We consider this a “surprising” effect, suggesting that the data is not just random noise. In this case, we <strong>reject the null hypothesis (<span class="math inline">\(H_0\)</span>)</strong>. This implies there is statistically significant evidence to support the alternative hypothesis.</p></li>
<li><p><strong>If the p-value &gt; <span class="math inline">\(\alpha\)</span>:</strong> This means the observed data is <em>not</em> surprising under the assumption that the null hypothesis is true. The data is consistent with random variation. In this case, we <strong>fail to reject the null hypothesis (<span class="math inline">\(H_0\)</span>)</strong>. This means there isn’t enough statistically significant evidence to support the alternative hypothesis.</p></li>
</ul>
</section>
<section id="types-of-errors" class="level3">
<h3 class="anchored" data-anchor-id="types-of-errors">Types of Errors</h3>
<p>When making a decision about the null hypothesis, there’s always a possibility of making an error:</p>
<ul>
<li><p><strong>Type I Error (<span class="math inline">\(\alpha\)</span>):</strong> This occurs when we <strong>reject a true null hypothesis</strong>. It’s a “false positive” – concluding there’s an effect when there isn’t one. The significance level (<span class="math inline">\(\alpha\)</span>) directly controls the probability of making a Type I error.</p></li>
<li><p><strong>Type II Error (<span class="math inline">\(\beta\)</span>):</strong> This occurs when we <strong>fail to reject a false null hypothesis</strong>. It’s a “false negative” – concluding there’s no effect when there actually is one.</p></li>
</ul>
</section>
<section id="drawing-conclusions" class="level3">
<h3 class="anchored" data-anchor-id="drawing-conclusions">Drawing Conclusions</h3>
<p>In hypothesis testing, our conclusions are precise:</p>
<ul>
<li>We either <strong>Reject <span class="math inline">\(H_0\)</span></strong> or <strong>Fail to Reject <span class="math inline">\(H_0\)</span></strong>.</li>
<li>It’s crucial to avoid language that implies absolute proof or disproof. For example, we should never say, “The person is innocent,” but rather, “There is not sufficient evidence to show that the person is guilty.” Similarly, we don’t “accept” the null hypothesis; we simply state that we “fail to reject” it.</li>
</ul>
</section>
<section id="tests-for-comparing-groups" class="level3">
<h3 class="anchored" data-anchor-id="tests-for-comparing-groups">Tests for Comparing Groups</h3>
<p>When comparing two independent groups, different statistical tests and formulas for standard error are used based on whether you’re comparing proportions or means.</p>
<section id="difference-in-means" class="level4">
<h4 class="anchored" data-anchor-id="difference-in-means">Difference in Means</h4>
<ul>
<li><strong>Distribution:</strong> Uses the <strong>t-distribution</strong>.</li>
<li><strong>Degrees of Freedom (df):</strong> The degrees of freedom are conservatively estimated as the smaller of <span class="math inline">\(n_1-1\)</span> or <span class="math inline">\(n_2-1\)</span>. More precise methods (like Welch’s t-test) use a more complex formula for df.</li>
<li><strong>Conditions:</strong>
<ul>
<li><span class="math inline">\(n_1 \ge 30\)</span> or data from group 1 is approximately normal.</li>
<li><strong>AND</strong> <span class="math inline">\(n_2 \ge 30\)</span> or data from group 2 is approximately normal.</li>
</ul></li>
<li><strong>Standard Error (SE):</strong> The standard error for the difference in means is:</li>
</ul>
<p><span class="math display">\[ \text{SE} = \sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}} \]</span></p>
<p>where <span class="math inline">\(s_1^2\)</span> and <span class="math inline">\(s_2^2\)</span> are the sample variances for group 1 and group 2, respectively, and <span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span> are their respective sample sizes.</p>
</section>
<section id="difference-in-proportions" class="level4">
<h4 class="anchored" data-anchor-id="difference-in-proportions">Difference in Proportions</h4>
<ul>
<li><strong>Distribution:</strong> Uses the <strong>Normal distribution</strong>.</li>
<li><strong>Conditions:</strong> All counts for both groups must be at least 10. That is, for Group 1: <span class="math inline">\(n_1\hat{p}_1 \ge 10\)</span> and <span class="math inline">\(n_1(1-\hat{p}_1) \ge 10\)</span>; and for Group 2: <span class="math inline">\(n_2\hat{p}_2 \ge 10\)</span> and <span class="math inline">\(n_2(1-\hat{p}_2) \ge 10\)</span>.</li>
<li><strong>Standard Error (SE):</strong> The standard error for the difference in proportions is:</li>
</ul>
<p><span class="math display">\[ \text{SE} = \sqrt{\frac{\hat{p}_1(1-\hat{p}_1)}{n_1} + \frac{\hat{p}_2(1-\hat{p}_2)}{n_2}} \]</span></p>
<p>where <span class="math inline">\(\hat{p}_1\)</span> and <span class="math inline">\(\hat{p}_2\)</span> are the sample proportions for group 1 and group 2, respectively, and <span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span> are their respective sample sizes.</p>
<!--#################################################-->
</section>
</section>
</section>
</section>
<section id="data-modelling" class="level1">
<h1><strong>Data Modelling</strong></h1>
<!--#################################################-->
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Contents
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><a href="#DMintro">Introduction</a></li>
<li><a href="#classical-ml">Classical Machine Learning</a></li>
<li><a href="#modelling-process">The Modelling Process</a></li>
<li><a href="#correlation">Understanding Relationships: Correlation</a></li>
<li><a href="#regression-models">Regression Models</a></li>
<li><a href="#ols">Finding the Best Fit: Ordinary Least Squares (OLS)</a></li>
<li><a href="#r-squared">Splitting Variability: Coefficient of Determination (<span class="math inline">\(R^2\)</span>)</a></li>
<li><a href="#sampling-error">Sampling Error in Regression and Significance of Estimates</a></li>
<li><a href="#prediction-intervals">Prediction Intervals</a></li>
<li><a href="#collinearity">Collinearity</a></li>
<li><a href="#categorical-variables">Categorical Variables</a></li>
<li><a href="#regression-applications">Examples of Regression Applications</a></li>
</ul>
</div>
</div>
</div>
<section id="DMintro" class="level3">
<h3 class="anchored" data-anchor-id="DMintro">Introduction</h3>
<p>Data modelling is a crucial step in understanding relationships between variables and building predictive or explanatory frameworks. It moves beyond simple descriptive statistics to develop models that can analyze performance, forecast trends, and make informed decisions in various business applications, such as targeting customers, credit scoring, understanding market share drivers, and forecasting sales. The primary objective is to determine how much of the variability in data can be explained by a model versus random error.</p>
<hr>
</section>
<section id="classical-ml" class="level3">
<h3 class="anchored" data-anchor-id="classical-ml">Classical Machine Learning</h3>
<p>Data modelling often falls under the umbrella of machine learning, which can be broadly categorized into:</p>
<ul>
<li><strong>Supervised Learning:</strong> Deals with labelled datd e.g.&nbsp;pre-categorized/numerical data to predict an outcome.
<ul>
<li><strong>Classification:</strong> Predicts a category (e.g., “Divide the socks by color”).</li>
<li><strong>Regression:</strong> Predicts a number (e.g., “Divide the ties by length”).</li>
</ul></li>
<li><strong>Unsupervised Learning:</strong> Works with unlabeled data to find inherent structures or relationships.
<ul>
<li><strong>Clustering:</strong> Divides data by similarity (e.g., “Split up similar clothing into stacks”).</li>
<li><strong>Association:</strong> Identifies sequences or hidden dependencies (e.g., “Find what clothes I often wear together”).</li>
<li><strong>Dimension Reduction:</strong> Focuses on generalization (e.g., “Make the best outfits from the given clothes”).</li>
</ul></li>
</ul>
<hr>
</section>
<section id="modelling-process" class="level3">
<h3 class="anchored" data-anchor-id="modelling-process">The Modelling Process</h3>
<p>A typical data modelling process involves several stages:</p>
<ul>
<li><p><strong>Import:</strong> Read the data.</p></li>
<li><p><strong>Inspect:</strong> Understand variable definitions, units, and identify data issues such as missing values or incorrect entries.</p></li>
<li><p><strong>Clean:</strong> Address missing values (e.g., impute) and correctly code variables (numerical, factors, dates). Data may need to be rearranged into a tidy format using functions that we have previously learnt about.</p></li>
<li><p><strong>Explore (Exploratory Data Analysis - EDA):</strong> Articulate hypotheses, discuss with experts, and use visual tools like correlation charts, histograms, and scatter plots to understand the data’s patterns. This is critical to “get a feel” for the data and spot potential problems.</p></li>
</ul>
<hr>
</section>
<section id="correlation" class="level3">
<h3 class="anchored" data-anchor-id="correlation">Understanding Relationships: Correlation</h3>
<p>Before building complex models, it’s essential to understand the relationships between individual variables.</p>
</section>
<section id="what-is-correlation" class="level3">
<h3 class="anchored" data-anchor-id="what-is-correlation">What is Correlation?</h3>
<p><strong>Correlation</strong> measures how closely two variables are related and the direction of their relationship. It indicates whether variables tend to move in the same (positive relationship) or opposite (negative relationship) direction.</p>
<p>The <strong>Pearson correlation coefficient (<span class="math inline">\(r_{xy}\)</span>)</strong> is calculated using the formula:</p>
<p><span class="math display">\[ r_{xy} = \frac{\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum_{i=1}^{n}(x_i - \bar{x})^2 \sum_{i=1}^{n}(y_i - \bar{y})^2}} \]</span></p>
</section>
<section id="key-properties-of-correlation" class="level3">
<h3 class="anchored" data-anchor-id="key-properties-of-correlation">Key Properties of Correlation:</h3>
<ul>
<li>It is always between -1 and +1.</li>
<li>A value of <strong>+1</strong> indicates a <strong>perfect positive correlation</strong> (variables move together in the same direction).</li>
<li>A value of <strong>-1</strong> indicates a <strong>perfect negative correlation</strong> (variables move in opposite directions).</li>
<li>A correlation of <strong>zero</strong> implies no linear relationship between the variables.</li>
</ul>
</section>
<section id="interpreting-correlation-strength" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-correlation-strength">Interpreting Correlation Strength:</h3>
<ul>
<li><strong>0:</strong> No relationship</li>
<li><strong>0.01-0.19:</strong> Little to no relationship</li>
<li><strong>0.20-0.29:</strong> Weak relationship</li>
<li><strong>0.30-0.39:</strong> Moderate relationship</li>
<li><strong>0.40-0.69:</strong> Strong relationship</li>
<li><strong>0.70-0.99:</strong> Very strong relationship</li>
<li><strong>1:</strong> Perfect relationship</li>
</ul>
</section>
<section id="visualizing-correlation" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-correlation">Visualizing Correlation:</h3>
<p><strong>Scatter plots</strong> are essential for visualizing relationships and can reveal non-linear patterns even if the correlation coefficient is moderate.</p>
<p><img src="Images/correlations.png" class="img-fluid"></p>
<hr>
</section>
<section id="regression-models" class="level3">
<h3 class="anchored" data-anchor-id="regression-models">Regression Models</h3>
<p><strong>Regression analysis</strong> is used to find actual relationships between variables and to forecast or explain outcomes.</p>
</section>
<section id="purposes-of-regression" class="level3">
<h3 class="anchored" data-anchor-id="purposes-of-regression">Purposes of Regression:</h3>
<ul>
<li><strong>Prediction:</strong> Focuses on forecasting future outcomes (Y). The goal is to make the best prediction of Y, often including many variables (e.g., predicting the price of a used car, guessing your next Netflix show).</li>
<li><strong>Explanation:</strong> Focuss on understanding the effect of specific explanatory variables (X) on the outcome (Y). This requires a theoretical reason for including each variable (e.g., effect of mileage on car price, effect of time of day on show selection).</li>
</ul>
</section>
<section id="terminology" class="level3">
<h3 class="anchored" data-anchor-id="terminology">Terminology:</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 48%">
<col style="width: 51%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable you want to explain or predict</th>
<th style="text-align: left;">Variable to help you explain changes in Y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Outcome variable</td>
<td style="text-align: left;">Explanatory variable</td>
</tr>
<tr class="even">
<td style="text-align: left;">Response variable</td>
<td style="text-align: left;">Predictor variable</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Dependent variable (Y)</strong></td>
<td style="text-align: left;"><strong>Independent variable (X or Xs)</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">Target variable</td>
<td style="text-align: left;">Regressor</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Export to Sheets</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</section>
<section id="linear-regression-equation" class="level3">
<h3 class="anchored" data-anchor-id="linear-regression-equation">Linear Regression Equation</h3>
<p>A simple linear regression model estimates the relationship between two variables using a straight line. The equation is typically represented as:</p>
<p><span class="math display">\[ y = \beta_0 + \beta_1 x_1 + \epsilon \]</span></p>
<p>Or, more simply:</p>
<p><span class="math display">\[ y = mx + b \]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(y\)</span>: The dependent/outcome variable.</li>
<li><span class="math inline">\(x\)</span> (or <span class="math inline">\(x_1\)</span>): The independent/explanatory variable.</li>
<li><span class="math inline">\(m\)</span> (or <span class="math inline">\(\beta_1\)</span>): The slope or gradient, representing the change in <span class="math inline">\(y\)</span> for a one-unit change in <span class="math inline">\(x\)</span>.</li>
<li><span class="math inline">\(b\)</span> (or <span class="math inline">\(\beta_0\)</span>): The y-intercept, the predicted value of <span class="math inline">\(y\)</span> when <span class="math inline">\(x\)</span> is zero.</li>
<li><span class="math inline">\(\epsilon\)</span>: The error term or residual, representing the difference between the observed <span class="math inline">\(y\)</span> value and the value predicted by the model.</li>
</ul>
<p><strong>Multiple regression</strong> involves multiple explanatory variables.</p>
<hr>
</section>
<section id="OLS" class="level3">
<h3 class="anchored" data-anchor-id="OLS">Finding the Best Fit: Ordinary Least Squares</h3>
<p>The <strong>Ordinary Least Squares (OLS)</strong> algorithm is used to find the “best-fitting” line by determining the parameters (slope and intercept) that satisfy two conditions:</p>
<ul>
<li>The <strong>average error is zero</strong>: Under-estimates and over-estimates cancel out, ensuring no bias. This also means the regression line passes through the point of the average x-value and average y-value (<span class="math inline">\(\bar{x}, \bar{y}\)</span>).</li>
<li>The <strong>average squared error is as small as possible</strong>: This minimizes the scatter of points around the line, making the standard deviation of the residual errors as small as possible.</li>
</ul>
<hr>
</section>
<section id="r-squared" class="level3">
<h3 class="anchored" data-anchor-id="r-squared">Splitting Variability: Coefficient of Determination (<span class="math inline">\(R^2\)</span>)</h3>
<p>Regression models aim to explain the total variability in the dependent variable (Y). This variability can be split into parts explained by the model and parts remaining as error.</p>
<ul>
<li><strong>SST (Total Sum of Squares):</strong> Total variability between Y variable values and the mean value of Y.</li>
<li><strong>SSR (Residual Sum of Squares):</strong> Residual/Error variability, the variability between the regression model and the actual data.</li>
<li><strong>SSM (Model Sum of Squares):</strong> Model variability, the difference in variability between the model and the mean.</li>
</ul>
<p>The relationship is: <span class="math inline">\(SST_{Total} = SSM_{Model} + SSR_{Residual}\)</span></p>
<p><strong><span class="math inline">\(R^2\)</span> (R-squared)</strong> is the proportion of the total variability of Y that is explained by the model. It is calculated as:</p>
<p><span class="math display">\[ R^2 = \frac{SSM}{SST} \]</span></p>
<p><span class="math inline">\(R^2\)</span> ranges from 0% to 100%. A higher <span class="math inline">\(R^2\)</span> indicates that the model explains a larger proportion of the variance in the dependent variable. <strong>Adjusted <span class="math inline">\(R^2\)</span></strong> accounts for the number of observations and independent variables, providing a more robust measure of fit.</p>
<hr>
</section>
<section id="sampling-error" class="level3">
<h3 class="anchored" data-anchor-id="sampling-error">Sampling Error in Regression and Significance of Estimates</h3>
<p>Since regression parameters (coefficients <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> or <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>) are estimated from a sample, they are subject to sampling error. To determine if an explanatory variable “really” matters or if its coefficient estimate is due to random sampling error, we perform a hypothesis test:</p>
<ul>
<li><strong>Null Hypothesis (<span class="math inline">\(H_0\)</span>):</strong> The coefficient of the explanatory variable is 0 (i.e., the variable has no effect on Y).</li>
<li><strong>Alternative Hypothesis (<span class="math inline">\(H_A\)</span>):</strong> The coefficient of the explanatory variable is not 0 (i.e., the variable has a significant effect on Y).</li>
</ul>
<p>We use the <strong>t-value</strong> and <strong>p-value</strong> to assess significance:</p>
<ul>
<li><strong>t-value:</strong> Measures how many standard errors the coefficient estimate is away from zero. If <span class="math inline">\(|t-\text{value}| &gt; 2\)</span> (or less than -2), the coefficient estimate is considered “very far” from 0.</li>
<li><strong>p-value:</strong> The probability of observing a coefficient estimate as extreme as, or more extreme than, what was observed, assuming the null hypothesis is true. If the p-value is less than the chosen significance level (e.g., 5%), we reject the null hypothesis, concluding the coefficient is statistically significant.</li>
</ul>
<hr>
</section>
<section id="prediction-intervals" class="level3">
<h3 class="anchored" data-anchor-id="prediction-intervals">Prediction Intervals</h3>
<p>After obtaining a regression model, you can predict values for Y based on new X values. An approximate 95% prediction interval for a predicted value is typically calculated as:</p>
<p><span class="math display">\[ \text{Predicted value} \pm 2 * \text{SE} \]</span></p>
<p>Where <span class="math inline">\(\text{SE}\)</span> is the standard error of the estimate, or standard deviation of residuals.</p>
<hr>
</section>
<section id="collinearity" class="level3">
<h3 class="anchored" data-anchor-id="collinearity">Collinearity</h3>
<p><strong>Collinearity</strong> occurs when two or more explanatory variables in a regression model are highly correlated with each other. This can cause problems in estimating the individual effects of the correlated variables. A common indicator of problematic collinearity is a <strong>Variance Inflation Factor (VIF) &gt; 10</strong> for a variable, suggesting it might need to be dropped and the regression re-run.</p>
<hr>
</section>
<section id="categorical-variables" class="level3">
<h3 class="anchored" data-anchor-id="categorical-variables">Categorical Variables</h3>
<p>Regression models can also incorporate <strong>categorical variables</strong> (e.g., gender, region) in addition to numerical ones.</p>
<hr>
</section>
<section id="regression-applications" class="level2">
<h2 class="anchored" data-anchor-id="regression-applications">Examples of Regression Applications</h2>
<p>Regression models are widely used. Examples include:</p>
<ul>
<li><strong>Brexit Data Models:</strong> Analyzing factors influencing “leave share” in the Brexit referendum, considering variables like <code>born_in_uk</code>, <code>degree</code>, and <code>age_18to24</code>. These models often involve assessing correlations between variables.</li>
<li><strong>Earnings and Height/Gender:</strong> Investigating if height and gender impact earnings. This highlights the importance of considering confounding variables that might bias estimates if omitted from the model.</li>
<li><strong>Pick-up Time Analysis:</strong> Modelling the relationship between average pick-up times, number of drivers, and surge price in a mobility platform.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><strong>AM01: Applied Statistics with Python</strong><br>
(Autumn 2024)<br>
London Business School<br>
<a href="https://www.london.edu/faculty-and-research/faculty-profiles/k/kostis-christodoulou" target="_blank">Kostis Christodoulou</a><br>
<a href="mailto:kchristodoulou@london.edu" target="_blank">kchristodoulou@london.edu</a><br>
all days all times<br>
Sussex Place LTs</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>All content licensed under a <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.<br>
Content © 2024 Kostis Christodoulou</p>
<p>This site, created with the <a href="https://bootswatch.com/cosmo/">cosmo theme</a> in <a href="https://quarto.org/">quarto</a>, is developed by <a href="https://www.linkedin.com/in/khushijaiswal-london/" target="_blank">Khushi Jaiswal</a>, LBS MAM 2024.</p>
</div>
  </div>
</footer>




</body></html>